---
title: Criar um provedor de contêiner do Windows PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- providers [PowerShell Programmer's Guide], container provider
- container providers [PowerShell Programmer's Guide]
ms.assetid: a7926647-0d18-45b2-967e-b31f92004bc4
caps.latest.revision: 5
ms.openlocfilehash: 8c111f8f2943043e4ad2a6a8677db4afe1b3cdab
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/03/2019
ms.locfileid: "56863162"
---
# <a name="creating-a-windows-powershell-container-provider"></a><span data-ttu-id="dab4a-102">Criar um provedor de contêineres do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="dab4a-102">Creating a Windows PowerShell Container Provider</span></span>

<span data-ttu-id="dab4a-103">Este tópico descreve como criar um provedor do Windows PowerShell que pode funcionar em armazenamentos de dados de várias camadas.</span><span class="sxs-lookup"><span data-stu-id="dab4a-103">This topic describes how to create a Windows PowerShell provider that can work on multi-layer data stores.</span></span> <span data-ttu-id="dab4a-104">Para esse tipo de armazenamento de dados, do armazenamento de nível superior contém os itens de raiz e cada nível subsequente é conhecido como um nó de itens filho.</span><span class="sxs-lookup"><span data-stu-id="dab4a-104">For this type of data store, the top level of the store contains the root items and each subsequent level is referred to as a node of child items.</span></span> <span data-ttu-id="dab4a-105">Ao permitir que o usuário trabalhar em nós filho, um usuário pode interagir hierarquicamente por meio do armazenamento de dados.</span><span class="sxs-lookup"><span data-stu-id="dab4a-105">By allowing the user to work on these child nodes, a user can interact hierarchically through the data store.</span></span>

<span data-ttu-id="dab4a-106">Provedores que podem trabalhar em repositórios de dados de vários níveis são chamados de provedores de contêiner do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="dab4a-106">Providers that can work on multi-level data stores are referred to as Windows PowerShell container providers.</span></span> <span data-ttu-id="dab4a-107">No entanto, lembre-se de que um provedor de contêiner do Windows PowerShell pode ser usado somente quando há um contêiner (não há contêineres aninhados) com itens nele.</span><span class="sxs-lookup"><span data-stu-id="dab4a-107">However, be aware that a Windows PowerShell container provider can be used only when there is one container (no nested containers) with items in it.</span></span> <span data-ttu-id="dab4a-108">Se houver contêineres aninhados, você deve implementar um provedor de navegação do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="dab4a-108">If there are nested containers, then you must implement a Windows PowerShell navigation provider.</span></span> <span data-ttu-id="dab4a-109">Para obter mais informações sobre a implementação do provedor de navegação do Windows PowerShell, consulte [criando um provedor de navegação do Windows PowerShell](./creating-a-windows-powershell-navigation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="dab4a-109">For more information about implementing Windows PowerShell navigation provider, see [Creating a Windows PowerShell Navigation Provider](./creating-a-windows-powershell-navigation-provider.md).</span></span>

> [!NOTE]
> <span data-ttu-id="dab4a-110">Você pode baixar o C# arquivo de origem (AccessDBSampleProvider04.cs) para este provedor usando o Microsoft Windows Software Development Kit para Windows Vista e o .NET Framework 3.0 Runtime Components.</span><span class="sxs-lookup"><span data-stu-id="dab4a-110">You can download the C# source file (AccessDBSampleProvider04.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="dab4a-111">Para obter instruções de download, consulte [como instalar o Windows PowerShell e o Download do SDK do Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="dab4a-111">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
> <span data-ttu-id="dab4a-112">Você pode baixar o C# arquivo de origem (AccessDBSampleProvider04.cs) para este provedor usando o Microsoft Windows Software Development Kit para Windows Vista e o .NET Framework 3.0 Runtime Components.</span><span class="sxs-lookup"><span data-stu-id="dab4a-112">You can download the C# source file (AccessDBSampleProvider04.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="dab4a-113">Para obter instruções de download, consulte [como instalar o Windows PowerShell e o Download do SDK do Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="dab4a-113">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="dab4a-114">Os arquivos de origem baixado estão disponíveis na  **\<amostras do PowerShell >** directory.</span><span class="sxs-lookup"><span data-stu-id="dab4a-114">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="dab4a-115">Para obter mais informações sobre outras implementações do provedor do Windows PowerShell, consulte [projetando seu provedor do Windows PowerShell](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="dab4a-115">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="dab4a-116">O provedor de contêiner do Windows PowerShell descrito aqui define o banco de dados como seu único contêiner, com as tabelas e linhas do banco de dados definidos como itens do contêiner.</span><span class="sxs-lookup"><span data-stu-id="dab4a-116">The Windows PowerShell container provider described here defines the database as its single container, with the tables and rows of the database defined as items of the container.</span></span>

> [!CAUTION]
> <span data-ttu-id="dab4a-117">Lembre-se de que este design pressupõe um banco de dados que tem um campo com a ID de nome e o tipo do campo é LongInteger.</span><span class="sxs-lookup"><span data-stu-id="dab4a-117">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

<span data-ttu-id="dab4a-118">Aqui está uma lista das seções neste tópico.</span><span class="sxs-lookup"><span data-stu-id="dab4a-118">Here is a list of the sections in this topic.</span></span> <span data-ttu-id="dab4a-119">Se você estiver familiarizado com a gravação de um provedor de contêiner do Windows PowerShell, leia essas informações na ordem em que ele é exibido.</span><span class="sxs-lookup"><span data-stu-id="dab4a-119">If you are unfamiliar with writing a Windows PowerShell container provider, please read this information in the order that it appears.</span></span> <span data-ttu-id="dab4a-120">No entanto, se você estiver familiarizado com a gravação de um provedor de contêiner do Windows PowerShell, vá diretamente para as informações que você precisa.</span><span class="sxs-lookup"><span data-stu-id="dab4a-120">However, if you are familiar with writing a Windows PowerShell container provider, please go directly to the information that you need.</span></span>

- [<span data-ttu-id="dab4a-121">Definindo uma classe de provedor de contêiner do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="dab4a-121">Defining a Windows PowerShell Container Provider Class</span></span>](#Defining-a-Windows-PowerShell-Container-Provider-Class)

- [<span data-ttu-id="dab4a-122">Definindo a funcionalidade de Base</span><span class="sxs-lookup"><span data-stu-id="dab4a-122">Defining Base Functionality</span></span>]()

- [<span data-ttu-id="dab4a-123">Recuperando itens filho</span><span class="sxs-lookup"><span data-stu-id="dab4a-123">Retrieving Child Items</span></span>](#Retrieving-Child-Items)

- [<span data-ttu-id="dab4a-124">Anexando parâmetros dinâmicos para a `Get-ChildItem` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="dab4a-124">Attaching Dynamic Parameters to the `Get-ChildItem` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet)

- [<span data-ttu-id="dab4a-125">Recuperando nomes de itens filho</span><span class="sxs-lookup"><span data-stu-id="dab4a-125">Retrieving Child Item Names</span></span>](#Retrieving-Child-Item-Names)

- <span data-ttu-id="dab4a-126">[Anexando parâmetros dinâmicos para a `Get-ChildItem` Cmdlet (nome)](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet-(Name))</span><span class="sxs-lookup"><span data-stu-id="dab4a-126">[Attaching Dynamic Parameters to the `Get-ChildItem` Cmdlet (Name)](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet-(Name))</span></span>

- [<span data-ttu-id="dab4a-127">Renomeando itens</span><span class="sxs-lookup"><span data-stu-id="dab4a-127">Renaming Items</span></span>](#Renaming-Items)

- [<span data-ttu-id="dab4a-128">Anexando parâmetros dinâmicos para a `Rename-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="dab4a-128">Attaching Dynamic Parameters to the  `Rename-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Rename-Item-Cmdlet)

- [<span data-ttu-id="dab4a-129">Criando novos itens</span><span class="sxs-lookup"><span data-stu-id="dab4a-129">Creating New Items</span></span>](#Creating-New-Items)

- [<span data-ttu-id="dab4a-130">Anexando parâmetros dinâmicos para a `New-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="dab4a-130">Attaching Dynamic Parameters to the `New-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-New-Item-Cmdlet)

- [<span data-ttu-id="dab4a-131">Removendo itens</span><span class="sxs-lookup"><span data-stu-id="dab4a-131">Removing a Items</span></span>](#Removing-Items)

- [<span data-ttu-id="dab4a-132">Anexando parâmetros dinâmicos para a `Remove-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="dab4a-132">Attaching Dynamic Parameters to the `Remove-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Remove-Item-Cmdlet)

- [<span data-ttu-id="dab4a-133">Consultar itens filho</span><span class="sxs-lookup"><span data-stu-id="dab4a-133">Querying for Child Items</span></span>](#Querying-for-Child-Items)

- [<span data-ttu-id="dab4a-134">Itens de cópia</span><span class="sxs-lookup"><span data-stu-id="dab4a-134">Coping Items</span></span>](#Copying-Items)

- [<span data-ttu-id="dab4a-135">Anexando parâmetros dinâmicos para a `Copy-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="dab4a-135">Attaching Dynamic Parameters to the  `Copy-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Copy-Item-Cmdlet)

- [<span data-ttu-id="dab4a-136">Exemplo de código</span><span class="sxs-lookup"><span data-stu-id="dab4a-136">Code Sample</span></span>](#Code-Sample)

- [<span data-ttu-id="dab4a-137">Definindo tipos de objeto e formatação</span><span class="sxs-lookup"><span data-stu-id="dab4a-137">Defining Object Types and Formatting</span></span>]()

- [<span data-ttu-id="dab4a-138">Criando o provedor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="dab4a-138">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-Provider)

- [<span data-ttu-id="dab4a-139">Testando o provedor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="dab4a-139">Testing the Windows PowerShell Provider</span></span>](#Testing-the-Windows-PowerShell-Provider)

## <a name="defining-a-windows-powershell-container-provider-class"></a><span data-ttu-id="dab4a-140">Definindo uma classe de provedor de contêiner do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="dab4a-140">Defining a Windows PowerShell Container Provider Class</span></span>

<span data-ttu-id="dab4a-141">Um provedor de contêiner do Windows PowerShell deve definir uma classe .NET que deriva de [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) classe base.</span><span class="sxs-lookup"><span data-stu-id="dab4a-141">A Windows PowerShell container provider must define a .NET class that derives from the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="dab4a-142">Aqui está a definição de classe para o provedor de contêiner do Windows PowerShell descrito nesta seção.</span><span class="sxs-lookup"><span data-stu-id="dab4a-142">Here is the class definition for the Windows PowerShell container provider described in this section.</span></span>

```csharp
   [CmdletProvider("AccessDB", ProviderCapabilities.None)]
   public class AccessDBProvider : ContainerCmdletProvider
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L34-L35 "AccessDBProviderSample04.cs")]

<span data-ttu-id="dab4a-143">Observe que, desta definição, da classe de [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) atributo inclui dois parâmetros.</span><span class="sxs-lookup"><span data-stu-id="dab4a-143">Notice that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="dab4a-144">O primeiro parâmetro especifica um nome amigável para o provedor que é usado pelo Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="dab4a-144">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="dab4a-145">O segundo parâmetro especifica os recursos específicos do Windows PowerShell que o provedor expõe para o tempo de execução do Windows PowerShell durante o processamento do comando.</span><span class="sxs-lookup"><span data-stu-id="dab4a-145">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="dab4a-146">Para esse provedor, não há nenhum recursos específicos do Windows PowerShell que são adicionados.</span><span class="sxs-lookup"><span data-stu-id="dab4a-146">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="dab4a-147">Definindo a funcionalidade de Base</span><span class="sxs-lookup"><span data-stu-id="dab4a-147">Defining Base Functionality</span></span>

<span data-ttu-id="dab4a-148">Conforme descrito em [projetando seu provedor do Windows PowerShell](./designing-your-windows-powershell-provider.md), o [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) classe deriva de várias outras classes fornecidas funcionalidade de provedor diferente.</span><span class="sxs-lookup"><span data-stu-id="dab4a-148">As described in [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="dab4a-149">Um provedor de contêiner do Windows PowerShell, portanto, precisa definir toda a funcionalidade fornecida por essas classes.</span><span class="sxs-lookup"><span data-stu-id="dab4a-149">A Windows PowerShell container provider, therefore, needs to define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="dab4a-150">Para implementar a funcionalidade para adicionar informações de inicialização de sessão específica e para liberação de recursos que são usados pelo provedor, consulte [criando um provedor básico do Windows PowerShell](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="dab4a-150">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="dab4a-151">No entanto, a maioria dos provedores (incluindo o provedor descrito aqui) pode usar a implementação padrão dessa funcionalidade fornecida pelo Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="dab4a-151">However, most providers (including the provider described here) can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="dab4a-152">Para obter acesso ao armazenamento de dados, o provedor deve implementar os métodos do [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) classe base.</span><span class="sxs-lookup"><span data-stu-id="dab4a-152">To get access to the data store, the provider must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="dab4a-153">Para obter mais informações sobre a implementação desses métodos, consulte [criando um provedor de unidade do Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="dab4a-153">For more information about implementing these methods, see [Creating an Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="dab4a-154">Para manipular os itens de um repositório de dados, como introdução, configuração e itens de compensação, o provedor deve implementar os métodos fornecidos pela [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) classe base.</span><span class="sxs-lookup"><span data-stu-id="dab4a-154">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="dab4a-155">Para obter mais informações sobre a implementação desses métodos, consulte [criando um provedor de Item do Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="dab4a-155">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

## <a name="retrieving-child-items"></a><span data-ttu-id="dab4a-156">Recuperando itens filho</span><span class="sxs-lookup"><span data-stu-id="dab4a-156">Retrieving Child Items</span></span>

<span data-ttu-id="dab4a-157">Para recuperar um item filho, o provedor de contêiner do Windows PowerShell deve substituir a [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método para dar suporte a chamadas a partir de `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="dab4a-157">To retrieve a child item, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method to support calls from the `Get-ChildItem` cmdlet.</span></span> <span data-ttu-id="dab4a-158">Esse método recupera itens filho do armazenamento de dados e os grava no pipeline como objetos.</span><span class="sxs-lookup"><span data-stu-id="dab4a-158">This method retrieves child items from the data store and writes them to the pipeline as objects.</span></span> <span data-ttu-id="dab4a-159">Se o `recurse` parâmetro do cmdlet for especificado, o método recupera todos os filhos, independentemente de qual nível, eles correm.</span><span class="sxs-lookup"><span data-stu-id="dab4a-159">If the `recurse` parameter of the cmdlet is specified, the method retrieves all children regardless of what level they are at.</span></span> <span data-ttu-id="dab4a-160">Se o `recurse` parâmetro não for especificado, o método recupera um único nível de filhos.</span><span class="sxs-lookup"><span data-stu-id="dab4a-160">If the `recurse` parameter is not specified, the method retrieves only a single level of children.</span></span>

<span data-ttu-id="dab4a-161">Aqui está a implementação do [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método para esse provedor.</span><span class="sxs-lookup"><span data-stu-id="dab4a-161">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method for this provider.</span></span> <span data-ttu-id="dab4a-162">Observe que esse método recupera os itens filho em todas as tabelas de banco de dados quando o caminho indica o banco de dados e recupera os itens filho das linhas da tabela, se o caminho indica uma tabela de dados.</span><span class="sxs-lookup"><span data-stu-id="dab4a-162">Notice that this method retrieves the child items in all database tables when the path indicates the Access database, and retrieves the child items from the rows of that table if the path indicates a data table.</span></span>

```csharp
protected override void GetChildItems(string path, bool recurse)
{
    // If path represented is a drive then the children in the path are
    // tables. Hence all tables in the drive represented will have to be
    // returned
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table, path, true);

            // if the specified item exists and recurse has been set then
            // all child items within it have to be obtained as well
            if (ItemExists(path) && recurse)
            {
                GetChildItems(path + pathSeparator + table.Name, recurse);
            }
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get the table name, row number and type of path from the
        // path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Obtain all the rows within the table
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);
            WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
        }
        else
        {
            // In this case, the path specified is not valid
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L311-L362 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchilditems"></a><span data-ttu-id="dab4a-163">Itens a lembrar sobre a implementação GetChildItems</span><span class="sxs-lookup"><span data-stu-id="dab4a-163">Things to Remember About Implementing GetChildItems</span></span>

<span data-ttu-id="dab4a-164">As seguintes condições podem ser aplicáveis à sua implementação de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="dab4a-164">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="dab4a-165">Ao definir a classe de provedor, um provedor de contêiner do Windows PowerShell pode declarar recursos de provedor de ExpandWildcards, filtro, incluir ou excluir, da [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeração.</span><span class="sxs-lookup"><span data-stu-id="dab4a-165">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="dab4a-166">Nesses casos, a implementação de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método precisa garantir que o caminho passado para o método atenda aos requisitos do especificado recursos.</span><span class="sxs-lookup"><span data-stu-id="dab4a-166">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="dab4a-167">Para fazer isso, o método deve acessar a propriedade apropriada, por exemplo, o [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriedades.</span><span class="sxs-lookup"><span data-stu-id="dab4a-167">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="dab4a-168">A implementação deste método deve levar em conta nenhuma forma de acesso para o item que pode tornar o item visível para o usuário.</span><span class="sxs-lookup"><span data-stu-id="dab4a-168">The implementation of this method should take into account any form of access to the item that might make the item visible to the user.</span></span> <span data-ttu-id="dab4a-169">Por exemplo, se um usuário tiver acesso de gravação para um arquivo usando o provedor FileSystem (fornecido pelo Windows PowerShell), mas não o acesso de leitura, o arquivo ainda existe e [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) retorna `true`.</span><span class="sxs-lookup"><span data-stu-id="dab4a-169">For example, if a user has write access to a file through the FileSystem provider (supplied by Windows PowerShell), but not read access, the file still exists and [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returns `true`.</span></span> <span data-ttu-id="dab4a-170">Sua implementação pode exigir a verificação de um item pai para ver se o filho pode ser enumerado.</span><span class="sxs-lookup"><span data-stu-id="dab4a-170">Your implementation might require the checking of a parent item to see if the child can be enumerated.</span></span>

- <span data-ttu-id="dab4a-171">Ao escrever vários itens, o [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método pode levar algum tempo.</span><span class="sxs-lookup"><span data-stu-id="dab4a-171">When writing multiple items, the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method can take some time.</span></span> <span data-ttu-id="dab4a-172">Você pode projetar seu provedor para gravar os itens usando o [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) método por vez.</span><span class="sxs-lookup"><span data-stu-id="dab4a-172">You can design your provider to write the items using the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method one at a time.</span></span> <span data-ttu-id="dab4a-173">Usando essa técnica apresentará os itens para o usuário em um fluxo.</span><span class="sxs-lookup"><span data-stu-id="dab4a-173">Using this technique will present the items to the user in a stream.</span></span>

- <span data-ttu-id="dab4a-174">Sua implementação de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) é responsável por impedir a recursão infinita quando há links circular e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="dab4a-174">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="dab4a-175">Uma exceção de terminação apropriada deve ser gerada para refletir uma condição desse tipo.</span><span class="sxs-lookup"><span data-stu-id="dab4a-175">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet"></a><span data-ttu-id="dab4a-176">Anexando parâmetros dinâmicos para o Cmdlet Get-ChildItem</span><span class="sxs-lookup"><span data-stu-id="dab4a-176">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet</span></span>

<span data-ttu-id="dab4a-177">Às vezes, o `Get-ChildItem` cmdlet que chama [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) requer parâmetros adicionais que são especificados dinamicamente em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="dab4a-177">Sometimes the `Get-ChildItem` cmdlet that calls [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="dab4a-178">Para fornecer esses parâmetros dinâmicos, o provedor de contêiner do Windows PowerShell deve implementar o [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-178">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) method.</span></span> <span data-ttu-id="dab4a-179">Esse método recupera parâmetros dinâmicos para o item no caminho indicado e retorna um objeto que tem propriedades e campos com análise de atributos, semelhantes a uma classe cmdlet ou um [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="dab4a-179">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="dab4a-180">O tempo de execução do Windows PowerShell usa o objeto retornado para adicionar os parâmetros para o `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="dab4a-180">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="dab4a-181">Este provedor de contêiner do Windows PowerShell não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-181">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="dab4a-182">No entanto, o código a seguir é a implementação padrão desse método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-182">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters](Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters)]  -->

## <a name="retrieving-child-item-names"></a><span data-ttu-id="dab4a-183">Recuperando nomes de itens filho</span><span class="sxs-lookup"><span data-stu-id="dab4a-183">Retrieving Child Item Names</span></span>

<span data-ttu-id="dab4a-184">Para recuperar os nomes dos itens filho, o provedor de contêiner do Windows PowerShell deve substituir a [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) método para dar suporte a chamadas a partir de `Get-ChildItem`cmdlet quando seu `Name` parâmetro for especificado.</span><span class="sxs-lookup"><span data-stu-id="dab4a-184">To retrieve the names of child items, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method to support calls from the `Get-ChildItem` cmdlet when its `Name` parameter is specified.</span></span> <span data-ttu-id="dab4a-185">Esse método recupera os nomes dos itens filho para os nomes de item de caminho ou filho especificados para todos os contêineres se o `returnAllContainers` parâmetro do cmdlet é especificado.</span><span class="sxs-lookup"><span data-stu-id="dab4a-185">This method retrieves the names of the child items for the specified path or child item names for all containers if the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="dab4a-186">Um nome de filho é a parte da folha de um caminho.</span><span class="sxs-lookup"><span data-stu-id="dab4a-186">A child name is the leaf portion of a path.</span></span> <span data-ttu-id="dab4a-187">Por exemplo, o nome do filho para o caminho c:\windows\system32\abc.dll é "abc.dll".</span><span class="sxs-lookup"><span data-stu-id="dab4a-187">For example, the child name for the path c:\windows\system32\abc.dll is "abc.dll".</span></span> <span data-ttu-id="dab4a-188">O nome do filho para o diretório c:\windows\system32 é "system32".</span><span class="sxs-lookup"><span data-stu-id="dab4a-188">The child name for the directory c:\windows\system32 is "system32".</span></span>

<span data-ttu-id="dab4a-189">Aqui está a implementação do [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) método para esse provedor.</span><span class="sxs-lookup"><span data-stu-id="dab4a-189">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method for this provider.</span></span> <span data-ttu-id="dab4a-190">Observe que o método recupera nomes de tabela se o caminho especificado indica o banco de dados do Access (unidade) e os números de linha, se o caminho indica uma tabela.</span><span class="sxs-lookup"><span data-stu-id="dab4a-190">Notice that the method retrieves table names if the specified path indicates the Access database (drive) and row numbers if the path indicates a table.</span></span>

```csharp
protected override void GetChildNames(string path,
                            ReturnContainers returnContainers)
{
    // If the path represented is a drive, then the child items are
    // tables. get the names of all the tables in the drive.
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table.Name, path, true);
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get type, table name and row number from path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Get all the rows in the table and then write out the
            // row numbers.
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row.RowNumber, path, false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);

            WriteItemObject(row.RowNumber, path, false);
        }
        else
        {
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildNames
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L369-L411 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchildnames"></a><span data-ttu-id="dab4a-191">Itens a lembrar sobre a implementação GetChildNames</span><span class="sxs-lookup"><span data-stu-id="dab4a-191">Things to Remember About Implementing GetChildNames</span></span>

<span data-ttu-id="dab4a-192">As seguintes condições podem ser aplicáveis à sua implementação de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="dab4a-192">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="dab4a-193">Ao definir a classe de provedor, um provedor de contêiner do Windows PowerShell pode declarar recursos de provedor de ExpandWildcards, filtro, incluir ou excluir, da [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeração.</span><span class="sxs-lookup"><span data-stu-id="dab4a-193">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="dab4a-194">Nesses casos, a implementação de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método precisa garantir que o caminho passado para o método atenda aos requisitos do especificado recursos.</span><span class="sxs-lookup"><span data-stu-id="dab4a-194">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="dab4a-195">Para fazer isso, o método deve acessar a propriedade apropriada, por exemplo, o [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriedades.</span><span class="sxs-lookup"><span data-stu-id="dab4a-195">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

  > [!NOTE]
  > <span data-ttu-id="dab4a-196">Uma exceção a essa regra ocorre quando o `returnAllContainers` parâmetro do cmdlet é especificado.</span><span class="sxs-lookup"><span data-stu-id="dab4a-196">An exception to this rule occurs when the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="dab4a-197">Nesse caso, o método deve recuperar qualquer nome do filho para um contêiner, mesmo se ele não coincide com os valores da [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), ou [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) propriedades.</span><span class="sxs-lookup"><span data-stu-id="dab4a-197">In this case, the method should retrieve any child name for a container, even if it does not match the values of the [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), or [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) properties.</span></span>

- <span data-ttu-id="dab4a-198">Por padrão, substituições desse método não devem recuperar nomes de objetos que geralmente são ocultados do usuário, a menos que o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriedade for especificada.</span><span class="sxs-lookup"><span data-stu-id="dab4a-198">By default, overrides of this method should not retrieve names of objects that are generally hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="dab4a-199">Se o caminho especificado indica um contêiner, o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriedade não é necessária.</span><span class="sxs-lookup"><span data-stu-id="dab4a-199">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="dab4a-200">Sua implementação de [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) é responsável por impedir a recursão infinita quando há links circular e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="dab4a-200">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="dab4a-201">Uma exceção de terminação apropriada deve ser gerada para refletir uma condição desse tipo.</span><span class="sxs-lookup"><span data-stu-id="dab4a-201">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet-name"></a><span data-ttu-id="dab4a-202">Anexando parâmetros dinâmicos para o Cmdlet Get-ChildItem (nome)</span><span class="sxs-lookup"><span data-stu-id="dab4a-202">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet (Name)</span></span>

<span data-ttu-id="dab4a-203">Às vezes, o `Get-ChildItem` cmdlet (com o `Name` parâmetro) requer parâmetros adicionais que são especificados dinamicamente em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="dab4a-203">Sometimes the `Get-ChildItem` cmdlet (with the `Name` parameter) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="dab4a-204">Para fornecer esses parâmetros dinâmicos, o provedor de contêiner do Windows PowerShell deve implementar o [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-204">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) method.</span></span> <span data-ttu-id="dab4a-205">Esse método recupera os parâmetros dinâmicos para o item no caminho indicado e retorna um objeto que tem propriedades e campos com análise de atributos, semelhantes a uma classe cmdlet ou um [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="dab4a-205">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="dab4a-206">O tempo de execução do Windows PowerShell usa o objeto retornado para adicionar os parâmetros para o `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="dab4a-206">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="dab4a-207">Este provedor não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-207">This provider does not implement this method.</span></span> <span data-ttu-id="dab4a-208">No entanto, o código a seguir é a implementação padrão desse método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-208">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters](Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters)]  -->

## <a name="renaming-items"></a><span data-ttu-id="dab4a-209">Renomeando itens</span><span class="sxs-lookup"><span data-stu-id="dab4a-209">Renaming Items</span></span>

<span data-ttu-id="dab4a-210">Para renomear um item, um provedor de contêiner do Windows PowerShell deve substituir a [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) método para dar suporte a chamadas a partir de `Rename-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="dab4a-210">To rename an item, a Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method to support calls from the `Rename-Item` cmdlet.</span></span> <span data-ttu-id="dab4a-211">Esse método altera o nome do item no caminho especificado para o novo nome fornecido.</span><span class="sxs-lookup"><span data-stu-id="dab4a-211">This method changes the name of the item at the specified path to the new name provided.</span></span> <span data-ttu-id="dab4a-212">O novo nome sempre deve ser relativo ao item pai (contêiner).</span><span class="sxs-lookup"><span data-stu-id="dab4a-212">The new name must always be relative to the parent item (container).</span></span>

<span data-ttu-id="dab4a-213">Este provedor não substitui o [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-213">This provider does not override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method.</span></span> <span data-ttu-id="dab4a-214">No entanto, o seguinte é a implementação padrão.</span><span class="sxs-lookup"><span data-stu-id="dab4a-214">However, the following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitem](Msh_samplestestcmdlets#testproviderrenameitem)]  -->

#### <a name="things-to-remember-about-implementing-renameitem"></a><span data-ttu-id="dab4a-215">Itens a lembrar sobre a implementação RenameItem</span><span class="sxs-lookup"><span data-stu-id="dab4a-215">Things to Remember About Implementing RenameItem</span></span>

<span data-ttu-id="dab4a-216">As seguintes condições podem ser aplicáveis à sua implementação de [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span><span class="sxs-lookup"><span data-stu-id="dab4a-216">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span></span>

- <span data-ttu-id="dab4a-217">Ao definir a classe de provedor, um provedor de contêiner do Windows PowerShell pode declarar recursos de provedor de ExpandWildcards, filtro, incluir ou excluir, da [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeração.</span><span class="sxs-lookup"><span data-stu-id="dab4a-217">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="dab4a-218">Nesses casos, a implementação de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método precisa garantir que o caminho passado para o método atenda aos requisitos do especificado recursos.</span><span class="sxs-lookup"><span data-stu-id="dab4a-218">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="dab4a-219">Para fazer isso, o método deve acessar a propriedade apropriada, por exemplo, o [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriedades.</span><span class="sxs-lookup"><span data-stu-id="dab4a-219">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="dab4a-220">O [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) método destina-se para a modificação do nome de um item somente e não para operações de movimentação.</span><span class="sxs-lookup"><span data-stu-id="dab4a-220">The [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method is intended for the modification of the name of an item only, and not for move operations.</span></span> <span data-ttu-id="dab4a-221">Sua implementação do método deve gravar um erro se o `newName` parâmetro contém separadores de caminho ou, caso contrário, pode fazer com que o item alterar o local de seu pai.</span><span class="sxs-lookup"><span data-stu-id="dab4a-221">Your implementation of the method should write an error if the `newName` parameter contains path separators, or might otherwise cause the item to change its parent location.</span></span>

- <span data-ttu-id="dab4a-222">Por padrão, substituições desse método não devem o renomear objetos, a menos que o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriedade for especificada.</span><span class="sxs-lookup"><span data-stu-id="dab4a-222">By default, overrides of this method should not rename objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="dab4a-223">Se o caminho especificado indica um contêiner, o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriedade não é necessária.</span><span class="sxs-lookup"><span data-stu-id="dab4a-223">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="dab4a-224">Sua implementação do [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) método deve chamar [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e verificar seu valor de retorno antes de fazer alterações ao repositório de dados.</span><span class="sxs-lookup"><span data-stu-id="dab4a-224">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="dab4a-225">Esse método é usado para confirmar a execução de uma operação quando uma alteração é feita ao estado do sistema, por exemplo, renomear os arquivos.</span><span class="sxs-lookup"><span data-stu-id="dab4a-225">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span> <span data-ttu-id="dab4a-226">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) envia o nome do recurso a ser alterado para o usuário, com o tempo de execução do Windows PowerShell levando em consideração quaisquer configurações de linha de comando ou variáveis de preferência em Determinando o que deve ser exibido.</span><span class="sxs-lookup"><span data-stu-id="dab4a-226">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="dab4a-227">Após a chamada para [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retorna `true`, o [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) método deve chamar o [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-227">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="dab4a-228">Esse método envia uma mensagem de confirmação de uma mensagem para o usuário para permitir que os comentários adicionais dizer se a operação deve continuar.</span><span class="sxs-lookup"><span data-stu-id="dab4a-228">This method sends a message a confirmation message to the user to allow additional feedback to say if the operation should be continued.</span></span> <span data-ttu-id="dab4a-229">Um provedor deve chamar [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) como uma verificação adicional para modificações no sistema potencialmente perigosos.</span><span class="sxs-lookup"><span data-stu-id="dab4a-229">A provider should call [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-rename-item-cmdlet"></a><span data-ttu-id="dab4a-230">Anexando parâmetros dinâmicos para o Cmdlet Rename-Item</span><span class="sxs-lookup"><span data-stu-id="dab4a-230">Attaching Dynamic Parameters to the Rename-Item Cmdlet</span></span>

<span data-ttu-id="dab4a-231">Às vezes, o `Rename-Item` cmdlet requer parâmetros adicionais que são especificados dinamicamente em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="dab4a-231">Sometimes the `Rename-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="dab4a-232">Para fornecer esses parâmetros dinâmicos, o provedor de contêiner do Windows PowerShell deve implementar o [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-232">To provide these dynamic parameters, Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) method.</span></span> <span data-ttu-id="dab4a-233">Esse método recupera os parâmetros para o item no caminho indicado e retorna um objeto que tem propriedades e campos com análise de atributos, semelhantes a uma classe cmdlet ou um [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="dab4a-233">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="dab4a-234">O tempo de execução do Windows PowerShell usa o objeto retornado para adicionar os parâmetros para o `Rename-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="dab4a-234">The Windows PowerShell runtime uses the returned object to add the parameters to the `Rename-Item` cmdlet.</span></span>

<span data-ttu-id="dab4a-235">Este provedor de recipiente não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-235">This container provider does not implement this method.</span></span> <span data-ttu-id="dab4a-236">No entanto, o código a seguir é a implementação padrão desse método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-236">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters](Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters)]  -->

## <a name="creating-new-items"></a><span data-ttu-id="dab4a-237">Criando novos itens</span><span class="sxs-lookup"><span data-stu-id="dab4a-237">Creating New Items</span></span>

<span data-ttu-id="dab4a-238">Para criar novos itens, um provedor do contêiner deve implementar o [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método para dar suporte a chamadas a partir de `New-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="dab4a-238">To create new items, a container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method to support calls from the `New-Item` cmdlet.</span></span> <span data-ttu-id="dab4a-239">Esse método cria um item de dados localizado no caminho especificado.</span><span class="sxs-lookup"><span data-stu-id="dab4a-239">This method creates a data item located at the specified path.</span></span> <span data-ttu-id="dab4a-240">O `type` parâmetro do cmdlet contém o tipo definido pelo provedor para o novo item.</span><span class="sxs-lookup"><span data-stu-id="dab4a-240">The `type` parameter of the cmdlet contains the provider-defined type for the new item.</span></span> <span data-ttu-id="dab4a-241">Por exemplo, o provedor do sistema de arquivos usa um `type` parâmetro com um valor de "file" ou "directory".</span><span class="sxs-lookup"><span data-stu-id="dab4a-241">For example, the FileSystem provider uses a `type` parameter with a value of "file" or "directory".</span></span> <span data-ttu-id="dab4a-242">O `newItemValue` parâmetro do cmdlet especifica um valor específico do provedor para o novo item.</span><span class="sxs-lookup"><span data-stu-id="dab4a-242">The `newItemValue` parameter of the cmdlet specifies a provider-specific value for the new item.</span></span>

<span data-ttu-id="dab4a-243">Aqui está a implementação do [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método para esse provedor.</span><span class="sxs-lookup"><span data-stu-id="dab4a-243">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method for this provider.</span></span>

```csharp
protected override void NewItem( string path, string type,
                                 object newItemValue )
{
    // Create the new item here after
    // performing necessary validations
    //
    // WriteItemObject(newItemValue, path, false);

    // Example
    //
    // if (ShouldProcess(path, "new item"))
    // {
    //      // Create a new item and then call WriteObject
    //      WriteObject(newItemValue, path, false);
    // }

} // NewItem
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L939-L955 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-newitem"></a><span data-ttu-id="dab4a-244">Itens a lembrar sobre a implementação NewItem</span><span class="sxs-lookup"><span data-stu-id="dab4a-244">Things to Remember About Implementing NewItem</span></span>

<span data-ttu-id="dab4a-245">As seguintes condições podem ser aplicáveis à sua implementação de [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="dab4a-245">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="dab4a-246">O [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método precisar realizar uma comparação não diferencia maiusculas da cadeia de caracteres passada a `type` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="dab4a-246">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should perform a case-insensitive comparison of the string passed in the `type` parameter.</span></span> <span data-ttu-id="dab4a-247">Ele também deve permitir correspondências menos ambíguas.</span><span class="sxs-lookup"><span data-stu-id="dab4a-247">It should also allow for least ambiguous matches.</span></span> <span data-ttu-id="dab4a-248">Por exemplo, para os tipos "file" e "directory", somente a primeira letra é necessária para resolver a ambiguidade.</span><span class="sxs-lookup"><span data-stu-id="dab4a-248">For example, for the types "file" and "directory", only the first letter is required to disambiguate.</span></span> <span data-ttu-id="dab4a-249">Se o `type` parâmetro indica um tipo que não é possível criar o seu provedor, o [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método deve gravar uma ArgumentException com uma mensagem o provedor que indica os tipos pode criar.</span><span class="sxs-lookup"><span data-stu-id="dab4a-249">If the `type` parameter indicates a type your provider cannot create, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should write an ArgumentException with a message indicating the types the provider can create.</span></span>

- <span data-ttu-id="dab4a-250">Para o `newItemValue` parâmetro, a implementação do [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método é recomendado para aceitar as cadeias de caracteres de no mínimo.</span><span class="sxs-lookup"><span data-stu-id="dab4a-250">For the `newItemValue` parameter, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method is recommended to accept strings at a minimum.</span></span> <span data-ttu-id="dab4a-251">Ele também deve aceitar o tipo de objeto que é recuperado de [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) método para o mesmo caminho.</span><span class="sxs-lookup"><span data-stu-id="dab4a-251">It should also accept the type of object that is retrieved by the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for the same path.</span></span> <span data-ttu-id="dab4a-252">O [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método pode usar o [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) método para converter tipos o tipo desejado.</span><span class="sxs-lookup"><span data-stu-id="dab4a-252">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method can use the [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) method to convert types to the desired type.</span></span>

- <span data-ttu-id="dab4a-253">Sua implementação do [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método deve chamar [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e verificar seu valor de retorno antes de fazer alterações ao repositório de dados.</span><span class="sxs-lookup"><span data-stu-id="dab4a-253">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="dab4a-254">Após a chamada para [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retorna true, o [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método deve chamar o [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) método como uma verificação adicional para modificações no sistema potencialmente perigosos.</span><span class="sxs-lookup"><span data-stu-id="dab4a-254">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-new-item-cmdlet"></a><span data-ttu-id="dab4a-255">Anexando parâmetros dinâmicos para o Cmdlet New-Item</span><span class="sxs-lookup"><span data-stu-id="dab4a-255">Attaching Dynamic Parameters to the New-Item Cmdlet</span></span>

<span data-ttu-id="dab4a-256">Às vezes, o `New-Item` cmdlet requer parâmetros adicionais que são especificados dinamicamente em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="dab4a-256">Sometimes the `New-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="dab4a-257">Para fornecer esses parâmetros dinâmicos, o provedor do contêiner deve implementar o [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-257">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) method.</span></span> <span data-ttu-id="dab4a-258">Esse método recupera os parâmetros para o item no caminho indicado e retorna um objeto que tem propriedades e campos com análise de atributos, semelhantes a uma classe cmdlet ou um [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="dab4a-258">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="dab4a-259">O tempo de execução do Windows PowerShell usa o objeto retornado para adicionar os parâmetros para o `New-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="dab4a-259">The Windows PowerShell runtime uses the returned object to add the parameters to the `New-Item` cmdlet.</span></span>

<span data-ttu-id="dab4a-260">Este provedor não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-260">This provider does not implement this method.</span></span> <span data-ttu-id="dab4a-261">No entanto, o código a seguir é a implementação padrão desse método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-261">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernewitemdynamicparameters](Msh_samplestestcmdlets#testprovidernewitemdynamicparameters)]  -->

## <a name="removing-items"></a><span data-ttu-id="dab4a-262">Removendo itens</span><span class="sxs-lookup"><span data-stu-id="dab4a-262">Removing Items</span></span>

<span data-ttu-id="dab4a-263">Para remover itens, o provedor do Windows PowerShell deve substituir a [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) método para dar suporte a chamadas do `Remove-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="dab4a-263">To remove items, the Windows PowerShell provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method to support calls from the `Remove-Item` cmdlet.</span></span> <span data-ttu-id="dab4a-264">Este método exclui um item do armazenamento de dados no caminho especificado.</span><span class="sxs-lookup"><span data-stu-id="dab4a-264">This method deletes an item from the data store at the specified path.</span></span> <span data-ttu-id="dab4a-265">Se o `recurse` parâmetro do `Remove-Item` cmdlet é definida como `true`, o método Remove todos os itens filho, independentemente de seu nível.</span><span class="sxs-lookup"><span data-stu-id="dab4a-265">If the `recurse` parameter of the `Remove-Item` cmdlet is set to `true`, the method removes all child items regardless of their level.</span></span> <span data-ttu-id="dab4a-266">Se o parâmetro for definido como `false`, o método remove apenas um único item no caminho especificado.</span><span class="sxs-lookup"><span data-stu-id="dab4a-266">If the parameter is set to `false`, the method removes only a single item at the specified path.</span></span>

<span data-ttu-id="dab4a-267">Este provedor não dá suporte a remoção de item.</span><span class="sxs-lookup"><span data-stu-id="dab4a-267">This provider does not support item removal.</span></span> <span data-ttu-id="dab4a-268">No entanto, o código a seguir é a implementação padrão de [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span><span class="sxs-lookup"><span data-stu-id="dab4a-268">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitem](Msh_samplestestcmdlets#testproviderremoveitem)]  -->

#### <a name="things-to-remember-about-implementing-removeitem"></a><span data-ttu-id="dab4a-269">Itens a lembrar sobre a implementação RemoveItem</span><span class="sxs-lookup"><span data-stu-id="dab4a-269">Things to Remember About Implementing RemoveItem</span></span>

<span data-ttu-id="dab4a-270">As seguintes condições podem ser aplicáveis à sua implementação de [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="dab4a-270">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="dab4a-271">Ao definir a classe de provedor, um provedor de contêiner do Windows PowerShell pode declarar recursos de provedor de ExpandWildcards, filtro, incluir ou excluir, da [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeração.</span><span class="sxs-lookup"><span data-stu-id="dab4a-271">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="dab4a-272">Nesses casos, a implementação de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método precisa garantir que o caminho passado para o método atenda aos requisitos do especificado recursos.</span><span class="sxs-lookup"><span data-stu-id="dab4a-272">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="dab4a-273">Para fazer isso, o método deve acessar a propriedade apropriada, por exemplo, o [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriedades.</span><span class="sxs-lookup"><span data-stu-id="dab4a-273">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="dab4a-274">Por padrão, substituições desse método não devem o remover objetos, a menos que o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriedade é definida como true.</span><span class="sxs-lookup"><span data-stu-id="dab4a-274">By default, overrides of this method should not remove objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to true.</span></span> <span data-ttu-id="dab4a-275">Se o caminho especificado indica um contêiner, o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriedade não é necessária.</span><span class="sxs-lookup"><span data-stu-id="dab4a-275">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="dab4a-276">Sua implementação de [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) é responsável por impedir a recursão infinita quando há links circular e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="dab4a-276">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="dab4a-277">Uma exceção de terminação apropriada deve ser gerada para refletir uma condição desse tipo.</span><span class="sxs-lookup"><span data-stu-id="dab4a-277">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="dab4a-278">Sua implementação do [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) método deve chamar [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e verificar seu valor de retorno antes de fazer alterações ao repositório de dados.</span><span class="sxs-lookup"><span data-stu-id="dab4a-278">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="dab4a-279">Após a chamada para [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retorna `true`, o [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) método deve chamar o [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) método como uma verificação adicional para modificações no sistema potencialmente perigosos.</span><span class="sxs-lookup"><span data-stu-id="dab4a-279">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-remove-item-cmdlet"></a><span data-ttu-id="dab4a-280">Anexando parâmetros dinâmicos para o Cmdlet Remove-Item</span><span class="sxs-lookup"><span data-stu-id="dab4a-280">Attaching Dynamic Parameters to the Remove-Item Cmdlet</span></span>

<span data-ttu-id="dab4a-281">Às vezes, o `Remove-Item` cmdlet requer parâmetros adicionais que são especificados dinamicamente em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="dab4a-281">Sometimes the `Remove-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="dab4a-282">Para fornecer esses parâmetros dinâmicos, o provedor do contêiner deve implementar o [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) método para lidar com esses parâmetros.</span><span class="sxs-lookup"><span data-stu-id="dab4a-282">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="dab4a-283">Esse método recupera os parâmetros dinâmicos para o item no caminho indicado e retorna um objeto que tem propriedades e campos com análise de atributos, semelhantes a uma classe cmdlet ou um [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="dab4a-283">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="dab4a-284">O tempo de execução do Windows PowerShell usa o objeto retornado para adicionar os parâmetros para o `Remove-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="dab4a-284">The Windows PowerShell runtime uses the returned object to add the parameters to the `Remove-Item` cmdlet.</span></span>

<span data-ttu-id="dab4a-285">Este provedor de recipiente não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-285">This container provider does not implement this method.</span></span> <span data-ttu-id="dab4a-286">No entanto, o código a seguir é a implementação padrão de [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="dab4a-286">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters](Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters)]  -->

## <a name="querying-for-child-items"></a><span data-ttu-id="dab4a-287">Consultar itens filho</span><span class="sxs-lookup"><span data-stu-id="dab4a-287">Querying for Child Items</span></span>

<span data-ttu-id="dab4a-288">Para verificar se os itens filho existem no caminho especificado, o provedor de contêiner do Windows PowerShell deve substituir a [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-288">To check to see if child items exist at the specified path, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="dab4a-289">Esse método retornará `true` se o item tiver filhos, e `false` caso contrário.</span><span class="sxs-lookup"><span data-stu-id="dab4a-289">This method returns `true` if the item has children, and `false` otherwise.</span></span> <span data-ttu-id="dab4a-290">Para um caminho nulo ou vazio, o método considera todos os itens no armazenamento de dados para serem filhos e retorna `true`.</span><span class="sxs-lookup"><span data-stu-id="dab4a-290">For a null or empty path, the method considers any items in the data store to be children and returns `true`.</span></span>

<span data-ttu-id="dab4a-291">Aqui está a substituição para o [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-291">Here is the override for the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="dab4a-292">Se houver mais de duas partes do caminho criados pelo método auxiliar ChunkPath, o método retorna `false`, já que apenas um contêiner de banco de dados e um contêiner de tabela são definidos.</span><span class="sxs-lookup"><span data-stu-id="dab4a-292">If there are more than two path parts created by the ChunkPath helper method, the method returns `false`, since only a database container and a table container are defined.</span></span> <span data-ttu-id="dab4a-293">Para obter mais informações sobre esse método auxiliar, consulte o método ChunkPath é discutido [criando um provedor de Item do Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="dab4a-293">For more information about this helper method, see the ChunkPath method is discussed in [Creating a Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

```csharp
protected override bool HasChildItems( string path )
{
    return false;
} // HasChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L1094-L1097 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-haschilditems"></a><span data-ttu-id="dab4a-294">Itens a lembrar sobre a implementação HasChildItems</span><span class="sxs-lookup"><span data-stu-id="dab4a-294">Things to Remember About Implementing HasChildItems</span></span>

<span data-ttu-id="dab4a-295">As seguintes condições podem ser aplicáveis à sua implementação de [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span><span class="sxs-lookup"><span data-stu-id="dab4a-295">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span></span>

- <span data-ttu-id="dab4a-296">Se o provedor do contêiner expõe uma raiz que contém os pontos de montagem interessante, a implementação de [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) método deverá retornar `true`quando um valor nulo ou uma cadeia de caracteres vazia é passada para o caminho.</span><span class="sxs-lookup"><span data-stu-id="dab4a-296">If the container provider exposes a root that contains interesting mount points, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method should return `true` when a null or an empty string is passed in for the path.</span></span>

## <a name="copying-items"></a><span data-ttu-id="dab4a-297">Copiando itens</span><span class="sxs-lookup"><span data-stu-id="dab4a-297">Copying Items</span></span>

<span data-ttu-id="dab4a-298">Para copiar itens, o provedor do contêiner deve implementar o [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) método para dar suporte a chamadas a partir de `Copy-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="dab4a-298">To copy items, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method to support calls from the `Copy-Item` cmdlet.</span></span> <span data-ttu-id="dab4a-299">Esse método copia um item de dados do local indicado pelo `path` parâmetro do cmdlet para o local indicado pelo `copyPath` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="dab4a-299">This method copies a data item from the location indicated by the `path` parameter of the cmdlet to the location indicated by the `copyPath` parameter.</span></span> <span data-ttu-id="dab4a-300">Se o `recurse` parâmetro for especificado, o método copia todos os sub-recipientes.</span><span class="sxs-lookup"><span data-stu-id="dab4a-300">If the `recurse` parameter is specified, the method copies all sub-containers.</span></span> <span data-ttu-id="dab4a-301">Se o parâmetro não for especificado, o método copia somente um único nível de itens.</span><span class="sxs-lookup"><span data-stu-id="dab4a-301">If the parameter is not specified, the method copies only a single level of items.</span></span>

<span data-ttu-id="dab4a-302">Este provedor não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-302">This provider does not implement this method.</span></span> <span data-ttu-id="dab4a-303">No entanto, o código a seguir é a implementação padrão de [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span><span class="sxs-lookup"><span data-stu-id="dab4a-303">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitem](Msh_samplestestcmdlets#testprovidercopyitem)]  -->

#### <a name="things-to-remember-about-implementing-copyitem"></a><span data-ttu-id="dab4a-304">Itens a lembrar sobre a implementação de CopyItem</span><span class="sxs-lookup"><span data-stu-id="dab4a-304">Things to Remember About Implementing CopyItem</span></span>

<span data-ttu-id="dab4a-305">As seguintes condições podem ser aplicáveis à sua implementação de [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span><span class="sxs-lookup"><span data-stu-id="dab4a-305">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span></span>

- <span data-ttu-id="dab4a-306">Ao definir a classe de provedor, um provedor de contêiner do Windows PowerShell pode declarar recursos de provedor de ExpandWildcards, filtro, incluir ou excluir, da [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeração.</span><span class="sxs-lookup"><span data-stu-id="dab4a-306">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="dab4a-307">Nesses casos, a implementação de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método precisa garantir que o caminho passado para o método atenda aos requisitos do especificado recursos.</span><span class="sxs-lookup"><span data-stu-id="dab4a-307">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="dab4a-308">Para fazer isso, o método deve acessar a propriedade apropriada, por exemplo, o [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriedades.</span><span class="sxs-lookup"><span data-stu-id="dab4a-308">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="dab4a-309">Por padrão, substituições desse método não devem copiar objetos em objetos existentes, a menos que o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) estiver definida como `true`.</span><span class="sxs-lookup"><span data-stu-id="dab4a-309">By default, overrides of this method should not copy objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="dab4a-310">Por exemplo, o provedor FileSystem não copiará c:\temp\abc.txt ao longo de um arquivo c:\abc.txt existente, a menos que o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) estiver definida como `true`.</span><span class="sxs-lookup"><span data-stu-id="dab4a-310">For example, the FileSystem provider will not copy c:\temp\abc.txt over an existing c:\abc.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="dab4a-311">Se o caminho especificado na `copyPath` parâmetro existe e indica um contêiner, o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriedade não é necessária.</span><span class="sxs-lookup"><span data-stu-id="dab4a-311">If the path specified in the `copyPath` parameter exists and indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="dab4a-312">Nesse caso, [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) deve copiar o item indicado pelo `path` parâmetro para o contêiner é indicado pelo `copyPath` parâmetro como um filho.</span><span class="sxs-lookup"><span data-stu-id="dab4a-312">In this case, [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) should copy the item indicated by the `path` parameter to the container indicated by the `copyPath` parameter as a child.</span></span>

- <span data-ttu-id="dab4a-313">Sua implementação de [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) é responsável por impedir a recursão infinita quando há links circular e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="dab4a-313">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="dab4a-314">Uma exceção de terminação apropriada deve ser gerada para refletir uma condição desse tipo.</span><span class="sxs-lookup"><span data-stu-id="dab4a-314">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="dab4a-315">Sua implementação do [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) método deve chamar [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e verificar seu valor de retorno antes de fazer alterações ao repositório de dados.</span><span class="sxs-lookup"><span data-stu-id="dab4a-315">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="dab4a-316">Após a chamada para [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retorna true, o [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) método deve chamar o [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) método como uma verificação adicional para modificações no sistema potencialmente perigosos.</span><span class="sxs-lookup"><span data-stu-id="dab4a-316">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span> <span data-ttu-id="dab4a-317">Para obter mais informações sobre como chamar esses métodos, consulte [renomear itens](#Renaming-Items).</span><span class="sxs-lookup"><span data-stu-id="dab4a-317">For more information about calling these methods, see [Rename Items](#Renaming-Items).</span></span>

## <a name="attaching-dynamic-parameters-to-the-copy-item-cmdlet"></a><span data-ttu-id="dab4a-318">Anexando parâmetros dinâmicos para o Cmdlet Copy-Item</span><span class="sxs-lookup"><span data-stu-id="dab4a-318">Attaching Dynamic Parameters to the Copy-Item Cmdlet</span></span>

<span data-ttu-id="dab4a-319">Às vezes, o `Copy-Item` cmdlet requer parâmetros adicionais que são especificados dinamicamente em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="dab4a-319">Sometimes the `Copy-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="dab4a-320">Para fornecer esses parâmetros dinâmicos, o provedor de contêiner do Windows PowerShell deve implementar o [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) método para lidar com eles parâmetros.</span><span class="sxs-lookup"><span data-stu-id="dab4a-320">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="dab4a-321">Esse método recupera os parâmetros para o item no caminho indicado e retorna um objeto que tem propriedades e campos com análise de atributos, semelhantes a uma classe cmdlet ou um [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="dab4a-321">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="dab4a-322">O tempo de execução do Windows PowerShell usa o objeto retornado para adicionar os parâmetros para o `Copy-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="dab4a-322">The Windows PowerShell runtime uses the returned object to add the parameters to the `Copy-Item` cmdlet.</span></span>

<span data-ttu-id="dab4a-323">Este provedor não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="dab4a-323">This provider does not implement this method.</span></span> <span data-ttu-id="dab4a-324">No entanto, o código a seguir é a implementação padrão de [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="dab4a-324">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters](Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters)]  -->

## <a name="code-sample"></a><span data-ttu-id="dab4a-325">Exemplo de código</span><span class="sxs-lookup"><span data-stu-id="dab4a-325">Code Sample</span></span>

<span data-ttu-id="dab4a-326">Para o código de exemplo completo, consulte [exemplo de código AccessDbProviderSample04](./accessdbprovidersample04-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="dab4a-326">For complete sample code, see [AccessDbProviderSample04 Code Sample](./accessdbprovidersample04-code-sample.md).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="dab4a-327">Criando o provedor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="dab4a-327">Building the Windows PowerShell Provider</span></span>

<span data-ttu-id="dab4a-328">Ver [como registrar Cmdlets, provedores e hospedar aplicativos](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="dab4a-328">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>
<span data-ttu-id="dab4a-329">Ver [como registrar Cmdlets, provedores e hospedar aplicativos](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="dab4a-329">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="dab4a-330">Testando o provedor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="dab4a-330">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="dab4a-331">Quando o provedor do Windows PowerShell tiver sido registrado com o Windows PowerShell, você pode testá-lo, executando os cmdlets com suporte na linha de comando.</span><span class="sxs-lookup"><span data-stu-id="dab4a-331">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="dab4a-332">Lembre-se de que a saída de exemplo a seguir usa um banco de dados fictício.</span><span class="sxs-lookup"><span data-stu-id="dab4a-332">Be aware that the following example output uses a fictitious Access database.</span></span>

1. <span data-ttu-id="dab4a-333">Execute o `Get-ChildItem` cmdlet para recuperar a lista de itens filho de uma tabela de clientes no banco de dados do Access.</span><span class="sxs-lookup"><span data-stu-id="dab4a-333">Run the `Get-ChildItem` cmdlet to retrieve the list of child items from a Customers table in the Access database.</span></span>

   ```powershell
   Get-ChildItem mydb:customers
   ```

   <span data-ttu-id="dab4a-334">A seguinte saída é exibida.</span><span class="sxs-lookup"><span data-stu-id="dab4a-334">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : True
   Data          : System.Data.DataRow
   Name          : Customers
   RowCount      : 91
   Columns       :
   ```

2. <span data-ttu-id="dab4a-335">Execute o `Get-ChildItem` cmdlet novamente para recuperar os dados de uma tabela.</span><span class="sxs-lookup"><span data-stu-id="dab4a-335">Run the `Get-ChildItem` cmdlet again to retrieve the data of a table.</span></span>

   ```powershell
   (Get-ChildItem mydb:customers).data
   ```

   <span data-ttu-id="dab4a-336">A seguinte saída é exibida.</span><span class="sxs-lookup"><span data-stu-id="dab4a-336">The following output appears.</span></span>

   ```output
   TABLE_CAT   : c:\PS\northwind
   TABLE_SCHEM :
   TABLE_NAME  : Customers
   TABLE_TYPE  : TABLE
   REMARKS     :
   ```

3. <span data-ttu-id="dab4a-337">Agora use o `Get-Item` cmdlet para recuperar os itens na linha 0 na tabela de dados.</span><span class="sxs-lookup"><span data-stu-id="dab4a-337">Now use the `Get-Item` cmdlet to retrieve the items at row 0 in the data table.</span></span>

   ```powershell
   Get-Item mydb:\customers\0
   ```

   <span data-ttu-id="dab4a-338">A seguinte saída é exibida.</span><span class="sxs-lookup"><span data-stu-id="dab4a-338">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers\0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data          : System.Data.DataRow
   RowNumber     : 0
   ```

4. <span data-ttu-id="dab4a-339">Reutilizar `Get-Item` para recuperar os dados para os itens na linha 0.</span><span class="sxs-lookup"><span data-stu-id="dab4a-339">Reuse `Get-Item` to retrieve the data for the items in row 0.</span></span>

   ```powershell
   (Get-Item mydb:\customers\0).data
   ```

   <span data-ttu-id="dab4a-340">A seguinte saída é exibida.</span><span class="sxs-lookup"><span data-stu-id="dab4a-340">The following output appears.</span></span>

   ```output
   CustomerID   : 1234
   CompanyName  : Fabrikam
   ContactName  : Eric Gruber
   ContactTitle : President
   Address      : 4567 Main Street
   City         : Buffalo
   Region       : NY
   PostalCode   : 98052
   Country      : USA
   Phone        : (425) 555-0100
   Fax          : (425) 555-0101
   ```

5. <span data-ttu-id="dab4a-341">Agora use o `New-Item` cmdlet para adicionar uma linha a uma tabela existente.</span><span class="sxs-lookup"><span data-stu-id="dab4a-341">Now use the `New-Item` cmdlet to add a row to an existing table.</span></span> <span data-ttu-id="dab4a-342">O `Path` parâmetro especifica o caminho completo para a linha e deve indicar um número de linha que é maior que o número existente de linhas na tabela.</span><span class="sxs-lookup"><span data-stu-id="dab4a-342">The `Path` parameter specifies the full path to the row, and must indicate a row number that is greater than the existing number of rows in the table.</span></span> <span data-ttu-id="dab4a-343">O `Type` parâmetro indica "linha" para especificar que tipo de item a ser adicionado.</span><span class="sxs-lookup"><span data-stu-id="dab4a-343">The `Type` parameter indicates "row" to specify that type of item to add.</span></span> <span data-ttu-id="dab4a-344">Por fim, o `Value` parâmetro especifica uma lista delimitada por vírgulas de valores de coluna para a linha.</span><span class="sxs-lookup"><span data-stu-id="dab4a-344">Finally, the `Value` parameter specifies a comma-delimited list of column values for the row.</span></span>

   ```powershell
   New-Item -Path mydb:\Customers\3 -ItemType "row" -Value "3,CustomerFirstName,CustomerLastName,CustomerEmailAdress,CustomerTitle,CustomerCompany,CustomerPhone, CustomerAddress,CustomerCity,CustomerState,CustomerZip,CustomerCountry"
   ```

6. <span data-ttu-id="dab4a-345">Verificar a exatidão da nova operação de item da seguinte maneira.</span><span class="sxs-lookup"><span data-stu-id="dab4a-345">Verify the correctness of the new item operation as follows.</span></span>

   ```none
   PS mydb:\> cd Customers
   PS mydb:\Customers> (Get-Item 3).data
   ```

   <span data-ttu-id="dab4a-346">A seguinte saída é exibida.</span><span class="sxs-lookup"><span data-stu-id="dab4a-346">The following output appears.</span></span>

   ```output
   ID        : 3
   FirstName : Eric
   LastName  : Gruber
   Email     : ericgruber@fabrikam.com
   Title     : President
   Company   : Fabrikam
   WorkPhone : (425) 555-0100
   Address   : 4567 Main Street
   City      : Buffalo
   State     : NY
   Zip       : 98052
   Country   : USA
   ```

## <a name="see-also"></a><span data-ttu-id="dab4a-347">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="dab4a-347">See Also</span></span>

[<span data-ttu-id="dab4a-348">Criação de provedores do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="dab4a-348">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="dab4a-349">Criando o provedor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="dab4a-349">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="dab4a-350">Implementando um provedor de Item de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="dab4a-350">Implementing an Item Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-item-provider.md)

[<span data-ttu-id="dab4a-351">Implementando um provedor de PowerShell do Windows de navegação</span><span class="sxs-lookup"><span data-stu-id="dab4a-351">Implementing a Navigation Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-navigation-provider.md)

[<span data-ttu-id="dab4a-352">Como registrar Cmdlets, provedores e aplicativos de Host</span><span class="sxs-lookup"><span data-stu-id="dab4a-352">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="dab4a-353">Como registrar Cmdlets, provedores e aplicativos de Host</span><span class="sxs-lookup"><span data-stu-id="dab4a-353">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="dab4a-354">SDK do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="dab4a-354">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="dab4a-355">Guia do programador do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="dab4a-355">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)