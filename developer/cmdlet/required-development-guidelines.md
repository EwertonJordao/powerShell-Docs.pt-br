---
title: Diretrizes de desenvolvimento obrigatórias | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 41d2b308-a36a-496f-8542-666b6a21eedc
caps.latest.revision: 19
ms.openlocfilehash: 3f6bcd2e4ef4d9c404b3a5deeaa9f25d3fa42ec1
ms.sourcegitcommit: caac7d098a448232304c9d6728e7340ec7517a71
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/16/2019
ms.locfileid: "58056508"
---
# <a name="required-development-guidelines"></a><span data-ttu-id="7b0b9-102">Diretrizes para desenvolvimento necessárias</span><span class="sxs-lookup"><span data-stu-id="7b0b9-102">Required Development Guidelines</span></span>

<span data-ttu-id="7b0b9-103">As diretrizes a seguir devem ser seguidas ao escrever seus cmdlets.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-103">The following guidelines must be followed when you write your cmdlets.</span></span> <span data-ttu-id="7b0b9-104">Eles são separados em diretrizes para criação de cmdlets e diretrizes para escrever seu código do cmdlet.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-104">They are separated into guidelines for designing cmdlets and guidelines for writing your cmdlet code.</span></span> <span data-ttu-id="7b0b9-105">Se você não seguir essas diretrizes, seus cmdlets pode falhar e os usuários podem ter uma experiência ruim quando eles usam seus cmdlets.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-105">If you do not follow these guidelines, your cmdlets could fail, and your users might have a poor experience when they use your cmdlets.</span></span>

## <a name="in-this-topic"></a><span data-ttu-id="7b0b9-106">Neste tópico</span><span class="sxs-lookup"><span data-stu-id="7b0b9-106">In this Topic</span></span>

### <a name="design-guidelines"></a><span data-ttu-id="7b0b9-107">Diretrizes de design</span><span class="sxs-lookup"><span data-stu-id="7b0b9-107">Design Guidelines</span></span>

- [<span data-ttu-id="7b0b9-108">Usar somente aprovados verbos (RD01)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-108">Use Only Approved Verbs (RD01)</span></span>](./required-development-guidelines.md#use-only-approved-verbs-rd01)

- [<span data-ttu-id="7b0b9-109">Nomes de cmdlet: Caracteres que não podem ser usados (RD02)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-109">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>](./required-development-guidelines.md#cmdlet-names-characters-that-cannot-be-used-rd02)

- [<span data-ttu-id="7b0b9-110">Nomes de parâmetros que não podem ser usados (RD03)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-110">Parameters Names that cannot be Used (RD03)</span></span>](./required-development-guidelines.md#parameters-names-that-cannot-be-used-rd03)

- [<span data-ttu-id="7b0b9-111">Suporte a solicitações de confirmação (RD04)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-111">Support Confirmation Requests (RD04)</span></span>](./required-development-guidelines.md#support-confirmation-requests-rd04)

- [<span data-ttu-id="7b0b9-112">Suporte a parâmetro Force para sessões interativas (RD05)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-112">Support Force Parameter for Interactive Sessions (RD05)</span></span>](./required-development-guidelines.md#support-force-parameter-for-interactive-sessions-rd05)

- [<span data-ttu-id="7b0b9-113">Objetos de documento de saída (RD06)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-113">Document Output Objects (RD06)</span></span>](./required-development-guidelines.md#document-output-objects-rd06)

### <a name="code-guidelines"></a><span data-ttu-id="7b0b9-114">Diretrizes de código</span><span class="sxs-lookup"><span data-stu-id="7b0b9-114">Code Guidelines</span></span>

- [<span data-ttu-id="7b0b9-115">Derivar do Cmdlet ou Classes de PSCmdlet (RC01)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-115">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>](./required-development-guidelines.md#derive-from-the-cmdlet-or-pscmdlet-classes-rc01)

- [<span data-ttu-id="7b0b9-116">Especificar o atributo de Cmdlet (RC02)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-116">Specify the Cmdlet Attribute (RC02)</span></span>](./required-development-guidelines.md#specify-the-cmdlet-attribute-rc02)

- [<span data-ttu-id="7b0b9-117">Substituir uma método (RC03) de processamento de entrada</span><span class="sxs-lookup"><span data-stu-id="7b0b9-117">Override an Input Processing Method (RC03)</span></span>](./required-development-guidelines.md#override-an-input-processing-method-rc03)

- [<span data-ttu-id="7b0b9-118">Especificar o atributo OutputType (RC04)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-118">Specify the OutputType Attribute (RC04)</span></span>](./required-development-guidelines.md#specify-the-outputtype-attribute-rc04)

- [<span data-ttu-id="7b0b9-119">Não manterá os identificadores de objetos de saída (RC05)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-119">Do Not Retain Handles to Output Objects (RC05)</span></span>](./required-development-guidelines.md#do-not-retain-handles-to-output-objects-rc05)

- [<span data-ttu-id="7b0b9-120">Tratar erros robusto (RC06)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-120">Handle Errors Robustly (RC06)</span></span>](./required-development-guidelines.md#handle-errors-robustly-rc06)

- [<span data-ttu-id="7b0b9-121">Usar um módulo do Windows PowerShell para implantar seus Cmdlets (RC07)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-121">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>](./required-development-guidelines.md#use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07)

## <a name="design-guidelines"></a><span data-ttu-id="7b0b9-122">Diretrizes de design</span><span class="sxs-lookup"><span data-stu-id="7b0b9-122">Design Guidelines</span></span>

<span data-ttu-id="7b0b9-123">As diretrizes a seguir devem ser seguidas durante a criação de cmdlets para garantir uma experiência de usuário consistente entre o uso de seus cmdlets e outros cmdlets.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-123">The following guidelines must be followed when designing cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="7b0b9-124">Quando você encontrar uma diretriz de Design que se aplica à sua situação, certifique-se de examinar as diretrizes de código para obter diretrizes semelhantes.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-124">When you find a Design guideline that applies to your situation, be sure to look at the Code guidelines for similar guidelines.</span></span>

### <a name="use-only-approved-verbs-rd01"></a><span data-ttu-id="7b0b9-125">Usar somente aprovados verbos (RD01)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-125">Use Only Approved Verbs (RD01)</span></span>

<span data-ttu-id="7b0b9-126">O verbo especificado no atributo Cmdlet deve vir do reconhecido conjunto de verbos fornecidos pelo Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-126">The verb specified in the Cmdlet attribute must come from the recognized set of verbs provided by Windows PowerShell.</span></span> <span data-ttu-id="7b0b9-127">Ele não deve ser um dos sinônimos proibidos.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-127">It must not be one of the prohibited synonyms.</span></span> <span data-ttu-id="7b0b9-128">Use as cadeias de caracteres constante que são definidas pelas enumerações a seguir para especificar os verbos de cmdlet:</span><span class="sxs-lookup"><span data-stu-id="7b0b9-128">Use the constant strings that are defined by the following enumerations to specify cmdlet verbs:</span></span>

- [<span data-ttu-id="7b0b9-129">System.Management.Automation.VerbsCommon</span><span class="sxs-lookup"><span data-stu-id="7b0b9-129">System.Management.Automation.VerbsCommon</span></span>](/dotnet/api/System.Management.Automation.VerbsCommon)

- [<span data-ttu-id="7b0b9-130">System.Management.Automation.VerbsCommunications</span><span class="sxs-lookup"><span data-stu-id="7b0b9-130">System.Management.Automation.VerbsCommunications</span></span>](/dotnet/api/System.Management.Automation.VerbsCommunications)

- [<span data-ttu-id="7b0b9-131">System.Management.Automation.VerbsData</span><span class="sxs-lookup"><span data-stu-id="7b0b9-131">System.Management.Automation.VerbsData</span></span>](/dotnet/api/System.Management.Automation.VerbsData)

- [<span data-ttu-id="7b0b9-132">System.Management.Automation.VerbsDiagnostic</span><span class="sxs-lookup"><span data-stu-id="7b0b9-132">System.Management.Automation.VerbsDiagnostic</span></span>](/dotnet/api/System.Management.Automation.VerbsDiagnostic)

- [<span data-ttu-id="7b0b9-133">System.Management.Automation.VerbsLifeCycle</span><span class="sxs-lookup"><span data-stu-id="7b0b9-133">System.Management.Automation.VerbsLifeCycle</span></span>](/dotnet/api/System.Management.Automation.VerbsLifeCycle)

- [<span data-ttu-id="7b0b9-134">System.Management.Automation.VerbsSecurity</span><span class="sxs-lookup"><span data-stu-id="7b0b9-134">System.Management.Automation.VerbsSecurity</span></span>](/dotnet/api/System.Management.Automation.VerbsSecurity)

- [<span data-ttu-id="7b0b9-135">System.Management.Automation.VerbsOther</span><span class="sxs-lookup"><span data-stu-id="7b0b9-135">System.Management.Automation.VerbsOther</span></span>](/dotnet/api/System.Management.Automation.VerbsOther)

<span data-ttu-id="7b0b9-136">Para obter mais informações sobre os nomes de verbos aprovados, consulte [verbos de Cmdlet](./approved-verbs-for-windows-powershell-commands.md).</span><span class="sxs-lookup"><span data-stu-id="7b0b9-136">For more information about the approved verb names, see [Cmdlet Verbs](./approved-verbs-for-windows-powershell-commands.md).</span></span>

<span data-ttu-id="7b0b9-137">Os usuários precisam de um conjunto de nomes de cmdlet detectáveis e esperado.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-137">Users need a set of discoverable and expected cmdlet names.</span></span> <span data-ttu-id="7b0b9-138">Use o verbo apropriado para que o usuário possa fazer uma avaliação rápida do que um cmdlet faz e descubram facilmente os recursos do sistema.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-138">Use the appropriate verb so that the user can make a quick assessment of what a cmdlet does and to easily discover the capabilities of the system.</span></span> <span data-ttu-id="7b0b9-139">Por exemplo, a linha de comando a seguir obtém uma lista de todos os comandos do sistema cujos nomes começam com "start": `get-command start-*`.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-139">For example, the following command-line command gets a list of all the commands on the system whose names begin with "start": `get-command start-*`.</span></span> <span data-ttu-id="7b0b9-140">Use substantivos nos seus cmdlets para diferenciar seus cmdlets de outros cmdlets.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-140">Use the nouns in your cmdlets to differentiate your cmdlets from other cmdlets.</span></span> <span data-ttu-id="7b0b9-141">O substantivo indica o recurso no qual a operação será executada.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-141">The noun indicates the resource on which the operation will be performed.</span></span> <span data-ttu-id="7b0b9-142">A operação em si é representada pelo verbo.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-142">The operation itself is represented by the verb.</span></span>

### <a name="cmdlet-names-characters-that-cannot-be-used-rd02"></a><span data-ttu-id="7b0b9-143">Nomes de cmdlet: Caracteres que não podem ser usados (RD02)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-143">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>

<span data-ttu-id="7b0b9-144">Ao nomear cmdlets, não use nenhum dos seguintes caracteres especiais.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-144">When you name cmdlets, do not use any of the following special characters.</span></span>

|<span data-ttu-id="7b0b9-145">Caractere</span><span class="sxs-lookup"><span data-stu-id="7b0b9-145">Character</span></span>|<span data-ttu-id="7b0b9-146">Nome</span><span class="sxs-lookup"><span data-stu-id="7b0b9-146">Name</span></span>|
|---------------|----------|
|#|<span data-ttu-id="7b0b9-147">sinal de número</span><span class="sxs-lookup"><span data-stu-id="7b0b9-147">number sign</span></span>|
|<span data-ttu-id="7b0b9-148">,</span><span class="sxs-lookup"><span data-stu-id="7b0b9-148">,</span></span>|<span data-ttu-id="7b0b9-149">comma</span><span class="sxs-lookup"><span data-stu-id="7b0b9-149">comma</span></span>|
|<span data-ttu-id="7b0b9-150">()</span><span class="sxs-lookup"><span data-stu-id="7b0b9-150">()</span></span>|<span data-ttu-id="7b0b9-151">Parênteses</span><span class="sxs-lookup"><span data-stu-id="7b0b9-151">parentheses</span></span>|
|{}|<span data-ttu-id="7b0b9-152">chaves</span><span class="sxs-lookup"><span data-stu-id="7b0b9-152">braces</span></span>|
|<span data-ttu-id="7b0b9-153">[]</span><span class="sxs-lookup"><span data-stu-id="7b0b9-153">[]</span></span>|<span data-ttu-id="7b0b9-154">colchetes</span><span class="sxs-lookup"><span data-stu-id="7b0b9-154">brackets</span></span>|
|&|<span data-ttu-id="7b0b9-155">e comercial</span><span class="sxs-lookup"><span data-stu-id="7b0b9-155">ampersand</span></span>|
|-|<span data-ttu-id="7b0b9-156">hífen **Observação:**  O hífen pode ser usado para separar o verbo de substantivo, mas não pode ser usado dentro do substantivo ou dentro do verbo.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-156">hyphen **Note:**  The hyphen can be used to separate the verb from the noun, but it cannot be used within the noun or within the verb.</span></span>|
|/|<span data-ttu-id="7b0b9-157">marca de barra</span><span class="sxs-lookup"><span data-stu-id="7b0b9-157">slash mark</span></span>|
|<span data-ttu-id="7b0b9-158">\|barra invertida</span><span class="sxs-lookup"><span data-stu-id="7b0b9-158">\|backslash</span></span>|
|$|<span data-ttu-id="7b0b9-159">Sinal de cifrão</span><span class="sxs-lookup"><span data-stu-id="7b0b9-159">dollar sign</span></span>|
|^|<span data-ttu-id="7b0b9-160">Sinal de interpolação</span><span class="sxs-lookup"><span data-stu-id="7b0b9-160">caret</span></span>|
|<span data-ttu-id="7b0b9-161">;</span><span class="sxs-lookup"><span data-stu-id="7b0b9-161">;</span></span>|<span data-ttu-id="7b0b9-162">Ponto e vírgula</span><span class="sxs-lookup"><span data-stu-id="7b0b9-162">semicolon</span></span>|
|<span data-ttu-id="7b0b9-163">:</span><span class="sxs-lookup"><span data-stu-id="7b0b9-163">:</span></span>|<span data-ttu-id="7b0b9-164">Dois-pontos</span><span class="sxs-lookup"><span data-stu-id="7b0b9-164">colon</span></span>|
|<span data-ttu-id="7b0b9-165">"</span><span class="sxs-lookup"><span data-stu-id="7b0b9-165">"</span></span>|<span data-ttu-id="7b0b9-166">aspas duplas</span><span class="sxs-lookup"><span data-stu-id="7b0b9-166">double quotation mark</span></span>|
|<span data-ttu-id="7b0b9-167">'</span><span class="sxs-lookup"><span data-stu-id="7b0b9-167">'</span></span>|<span data-ttu-id="7b0b9-168">marca de aspas simples</span><span class="sxs-lookup"><span data-stu-id="7b0b9-168">single quotation mark</span></span>|
|<>|<span data-ttu-id="7b0b9-169">colchetes angulares</span><span class="sxs-lookup"><span data-stu-id="7b0b9-169">angle brackets</span></span>|
|<span data-ttu-id="7b0b9-170">&#124;</span><span class="sxs-lookup"><span data-stu-id="7b0b9-170">&#124;</span></span>|<span data-ttu-id="7b0b9-171">barra vertical</span><span class="sxs-lookup"><span data-stu-id="7b0b9-171">vertical bar</span></span>|
|<span data-ttu-id="7b0b9-172">?</span><span class="sxs-lookup"><span data-stu-id="7b0b9-172">?</span></span>|<span data-ttu-id="7b0b9-173">ponto de interrogação</span><span class="sxs-lookup"><span data-stu-id="7b0b9-173">question mark</span></span>|
|@|<span data-ttu-id="7b0b9-174">sinal de arroba</span><span class="sxs-lookup"><span data-stu-id="7b0b9-174">at sign</span></span>|
|<span data-ttu-id="7b0b9-175">' | fazer escala (acento grave)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-175">\`|back tick (grave accent)</span></span>|
|*|<span data-ttu-id="7b0b9-176">Asterisco</span><span class="sxs-lookup"><span data-stu-id="7b0b9-176">asterisk</span></span>|
|%|<span data-ttu-id="7b0b9-177">Sinal de porcentagem</span><span class="sxs-lookup"><span data-stu-id="7b0b9-177">percent sign</span></span>|
|+|<span data-ttu-id="7b0b9-178">Sinal de adição</span><span class="sxs-lookup"><span data-stu-id="7b0b9-178">plus sign</span></span>|
|=|<span data-ttu-id="7b0b9-179">Sinal de igual</span><span class="sxs-lookup"><span data-stu-id="7b0b9-179">equals sign</span></span>|
|~|<span data-ttu-id="7b0b9-180">Til</span><span class="sxs-lookup"><span data-stu-id="7b0b9-180">tilde</span></span>|

### <a name="parameters-names-that-cannot-be-used-rd03"></a><span data-ttu-id="7b0b9-181">Nomes de parâmetros que não podem ser usados (RD03)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-181">Parameters Names that cannot be Used (RD03)</span></span>

<span data-ttu-id="7b0b9-182">Windows PowerShell fornece um conjunto comum de parâmetros para todos os cmdlets e parâmetros adicionais que são adicionados em situações específicas.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-182">Windows PowerShell provides a common set a parameters to all cmdlets plus additional parameters that are added in specific situations.</span></span> <span data-ttu-id="7b0b9-183">Ao criar seus próprios cmdlets, você não pode usar os seguintes nomes: Confirmar, Debug, ErrorAction, ErrorVariable, OutBuffer, OutVariable, WarningAction, WarningVariable, WhatIf e UseTransaction e detalhado.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-183">When designing your own cmdlets you cannot use the following names: Confirm, Debug, ErrorAction, ErrorVariable, OutBuffer, OutVariable, WarningAction, WarningVariable, WhatIf, UseTransaction, and Verbose.</span></span> <span data-ttu-id="7b0b9-184">Para obter mais informações sobre esses parâmetros, consulte [nomes de parâmetro comuns](./common-parameter-names.md).</span><span class="sxs-lookup"><span data-stu-id="7b0b9-184">For more information about these parameters, see [Common Parameter Names](./common-parameter-names.md).</span></span>

### <a name="support-confirmation-requests-rd04"></a><span data-ttu-id="7b0b9-185">Suporte a solicitações de confirmação (RD04)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-185">Support Confirmation Requests (RD04)</span></span>

<span data-ttu-id="7b0b9-186">Para cmdlets que executam uma operação que modifique o sistema, eles devem chamar o [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) método solicitar uma confirmação e, em casos especiais, chamar o [ System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) método.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-186">For cmdlets that perform an operation that modifies the system, they should call the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method to request confirmation, and in special cases call the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method.</span></span> <span data-ttu-id="7b0b9-187">(O [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) método deve ser chamado somente depois da [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) método é chamado.)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-187">(The [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method should be called only after the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method is called.)</span></span>

<span data-ttu-id="7b0b9-188">Para fazer essas chamadas que o cmdlet deve especificar que ele oferece suporte a solicitações de confirmação, definindo o `SupportsShouldProcess` palavra-chave do atributo Cmdlet.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-188">To make these calls the cmdlet must specify that it supports confirmation requests by setting the `SupportsShouldProcess` keyword of the Cmdlet attribute.</span></span> <span data-ttu-id="7b0b9-189">Para obter mais informações sobre como definir esse atributo, consulte [declaração de atributo do Cmdlet](./cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="7b0b9-189">For more information about setting this attribute, see [Cmdlet Attribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

> [!NOTE]
> <span data-ttu-id="7b0b9-190">Se o atributo de Cmdlet de classe do cmdlet indica que o cmdlet oferece suporte a chamadas para o [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) método e o cmdlet não conseguir fazer a chamada para o [ System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) método, o usuário pode modificar o sistema inesperadamente.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-190">If the Cmdlet attribute of the cmdlet class indicates that the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, and the cmdlet fails to make the call to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, the user could modify the system unexpectedly.</span></span>

<span data-ttu-id="7b0b9-191">Use o [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) método para qualquer modificação do sistema.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-191">Use the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method for any system modification.</span></span> <span data-ttu-id="7b0b9-192">Uma preferência do usuário e o `WhatIf` controle de parâmetro de [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) método.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-192">A user preference and the `WhatIf` parameter control the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="7b0b9-193">Em contraste, o [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) chamada executa uma verificação adicional para modificações potencialmente perigosas.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-193">In contrast, the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) call performs an additional check for potentially dangerous modifications.</span></span> <span data-ttu-id="7b0b9-194">Esse método não é controlado por nenhuma preferência do usuário ou o `WhatIf` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-194">This method is not controlled by any user preference or the `WhatIf` parameter.</span></span> <span data-ttu-id="7b0b9-195">Se seu cmdlet chama o [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) método, ele deve ter um `Force` parâmetro que ignora as chamadas para esses dois métodos e que continua com a operação.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-195">If your cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method, it should have a `Force` parameter that bypasses the calls to these two methods and that proceeds with the operation.</span></span> <span data-ttu-id="7b0b9-196">Isso é importante porque permite que o cmdlet a ser usado em scripts não interativo e hosts.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-196">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span>

<span data-ttu-id="7b0b9-197">Se seus cmdlets do dão suporte a essas chamadas, o usuário pode determinar se a ação realmente deve ser executada.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-197">If your cmdlets support these calls, the user can determine whether the action should actually be performed.</span></span> <span data-ttu-id="7b0b9-198">Por exemplo, o [Stop-Process](/powershell/module/microsoft.powershell.management/stop-process) cmdlet chamadas a [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) método antes de parar um conjunto de processos críticos, incluindo o sistema, o Winlogon, e Spoolsv processos.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-198">For example, the [Stop-Process](/powershell/module/microsoft.powershell.management/stop-process) cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method before it stops a set of critical processes, including the System, Winlogon, and Spoolsv processes.</span></span>

<span data-ttu-id="7b0b9-199">Para obter mais informações sobre o suporte a esses métodos, consulte [solicitando confirmação](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="7b0b9-199">For more information about supporting these methods, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="support-force-parameter-for-interactive-sessions-rd05"></a><span data-ttu-id="7b0b9-200">Suporte a parâmetro Force para sessões interativas (RD05)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-200">Support Force Parameter for Interactive Sessions (RD05)</span></span>

<span data-ttu-id="7b0b9-201">Se seu cmdlet é usado interativamente, sempre forneça um parâmetro Force para substituir as ações interativas, como prompts ou a leitura de linhas de entrada).</span><span class="sxs-lookup"><span data-stu-id="7b0b9-201">If your cmdlet is used interactively, always provide a Force parameter to override the interactive actions, such as prompts or reading lines of input).</span></span> <span data-ttu-id="7b0b9-202">Isso é importante porque permite que o cmdlet a ser usado em scripts não interativo e hosts.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-202">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span> <span data-ttu-id="7b0b9-203">Os métodos a seguir podem ser implementados por um host interativo.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-203">The following methods can be implemented by an interactive host.</span></span>

- [<span data-ttu-id="7b0b9-204">System.Management.Automation.Host.PSHostUserInterface.Prompt\*</span><span class="sxs-lookup"><span data-stu-id="7b0b9-204">System.Management.Automation.Host.PSHostUserInterface.Prompt\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.Prompt)

- [<span data-ttu-id="7b0b9-205">System.Management.Automation.Host.Pshostuserinterface.PromptForChoice</span><span class="sxs-lookup"><span data-stu-id="7b0b9-205">System.Management.Automation.Host.Pshostuserinterface.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForChoice)

- [<span data-ttu-id="7b0b9-206">System.Management.Automation.Host.Ihostuisupportsmultiplechoiceselection.PromptForChoice</span><span class="sxs-lookup"><span data-stu-id="7b0b9-206">System.Management.Automation.Host.Ihostuisupportsmultiplechoiceselection.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.IHostUISupportsMultipleChoiceSelection.PromptForChoice)

- [<span data-ttu-id="7b0b9-207">System.Management.Automation.Host.Pshostuserinterface.PromptForCredential\*</span><span class="sxs-lookup"><span data-stu-id="7b0b9-207">System.Management.Automation.Host.Pshostuserinterface.PromptForCredential\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForCredential)

- [<span data-ttu-id="7b0b9-208">System.Management.Automation.Host.Pshostuserinterface.ReadLine\*</span><span class="sxs-lookup"><span data-stu-id="7b0b9-208">System.Management.Automation.Host.Pshostuserinterface.ReadLine\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLine)

- [<span data-ttu-id="7b0b9-209">System.Management.Automation.Host.Pshostuserinterface.ReadLineAsSecureString\*</span><span class="sxs-lookup"><span data-stu-id="7b0b9-209">System.Management.Automation.Host.Pshostuserinterface.ReadLineAsSecureString\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLineAsSecureString)

### <a name="document-output-objects-rd06"></a><span data-ttu-id="7b0b9-210">Objetos de documento de saída (RD06)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-210">Document Output Objects (RD06)</span></span>

<span data-ttu-id="7b0b9-211">Windows PowerShell usa os objetos que são escritos para o pipeline.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-211">Windows PowerShell uses the objects that are written to the pipeline.</span></span> <span data-ttu-id="7b0b9-212">Em ordem para que os usuários podem aproveitar os objetos que são retornados por cada cmdlet, você deve documentar os objetos que são retornados e você deve documentar o que os membros desses objetos retornados são usados para.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-212">In order for users to take advantage of the objects that are returned by each cmdlet, you must document the objects that are returned, and you must document what the members of those returned objects are used for.</span></span>

## <a name="code-guidelines"></a><span data-ttu-id="7b0b9-213">Diretrizes de código</span><span class="sxs-lookup"><span data-stu-id="7b0b9-213">Code Guidelines</span></span>

<span data-ttu-id="7b0b9-214">As diretrizes a seguir devem ser seguidas ao escrever o código do cmdlet.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-214">The following guidelines must be followed when writing cmdlet code.</span></span> <span data-ttu-id="7b0b9-215">Quando você encontrar uma diretriz de código que se aplica à sua situação, certifique-se de examinar as diretrizes de Design para obter diretrizes semelhantes.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-215">When you find a Code guideline that applies to your situation, be sure to look at the Design guidelines for similar guidelines.</span></span>

### <a name="derive-from-the-cmdlet-or-pscmdlet-classes-rc01"></a><span data-ttu-id="7b0b9-216">Derivar do Cmdlet ou Classes de PSCmdlet (RC01)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-216">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>

<span data-ttu-id="7b0b9-217">Um cmdlet deve derivar do [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) ou [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) classe base.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-217">A cmdlet must derive from either the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) or [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="7b0b9-218">Os cmdlets que derivam de [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) classe não dependem do tempo de execução do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-218">Cmdlets that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class do not depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="7b0b9-219">Eles podem ser chamados diretamente de qualquer linguagem do Microsoft .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-219">They can be called directly from any Microsoft .NET Framework language.</span></span> <span data-ttu-id="7b0b9-220">Os cmdlets que derivam de [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) classe dependem do tempo de execução do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-220">Cmdlets that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="7b0b9-221">Portanto, eles são executadas dentro de um espaço de execução.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-221">Therefore, they execute within a runspace.</span></span>

<span data-ttu-id="7b0b9-222">Todas as classes de cmdlet que você implementar devem ser classes públicas.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-222">All cmdlet classes that you implement must be public classes.</span></span> <span data-ttu-id="7b0b9-223">Para obter mais informações sobre essas classes de cmdlet, consulte [visão geral de Cmdlet](./cmdlet-overview.md).</span><span class="sxs-lookup"><span data-stu-id="7b0b9-223">For more information about these cmdlet classes, see [Cmdlet Overview](./cmdlet-overview.md).</span></span>

### <a name="specify-the-cmdlet-attribute-rc02"></a><span data-ttu-id="7b0b9-224">Especificar o atributo de Cmdlet (RC02)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-224">Specify the Cmdlet Attribute (RC02)</span></span>

<span data-ttu-id="7b0b9-225">Para um cmdlet seja reconhecida pelo Windows PowerShell, sua classe do .NET Framework deve ser decorada com o atributo de Cmdlet.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-225">For a cmdlet to be recognized by Windows PowerShell, its .NET Framework class must be decorated with the Cmdlet attribute.</span></span> <span data-ttu-id="7b0b9-226">Esse atributo especifica os seguintes recursos do cmdlet.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-226">This attribute specifies the following features of the cmdlet.</span></span>

- <span data-ttu-id="7b0b9-227">O par do verbo e substantivo que identifica o cmdlet.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-227">The verb-and-noun pair that identifies the cmdlet.</span></span>

- <span data-ttu-id="7b0b9-228">O conjunto de parâmetros padrão que é usado quando vários conjuntos de parâmetros são especificados.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-228">The default parameter set that is used when multiple parameter sets are specified.</span></span> <span data-ttu-id="7b0b9-229">O conjunto de parâmetros padrão é usado quando o Windows PowerShell não tem informações suficientes para determinar qual parâmetro definido para usar.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-229">The default parameter set is used when Windows PowerShell does not have enough information to determine which parameter set to use.</span></span>

- <span data-ttu-id="7b0b9-230">Indica se o cmdlet oferece suporte a chamadas para o [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) método.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-230">Indicates if the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="7b0b9-231">Esse método exibe uma mensagem de confirmação para o usuário antes que o cmdlet faz uma alteração no sistema.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-231">This method displays a confirmation message to the user before the cmdlet makes a change to the system.</span></span> <span data-ttu-id="7b0b9-232">Para obter mais informações sobre como as solicitações de confirmação são feitas, consulte [solicitando confirmação](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="7b0b9-232">For more information about how confirmation requests are made, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

- <span data-ttu-id="7b0b9-233">Indica o nível de impacto (ou severidade) da ação associada com a mensagem de confirmação.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-233">Indicate the impact level (or severity) of the action associated with the confirmation message.</span></span> <span data-ttu-id="7b0b9-234">Na maioria dos casos, o valor padrão de médio deve ser usado.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-234">In most cases, the default value of Medium should be used.</span></span> <span data-ttu-id="7b0b9-235">Para obter mais informações sobre como o nível de impacto afeta as solicitações de confirmação são exibidas ao usuário, consulte [solicitando confirmação](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="7b0b9-235">For more information about how the impact level affects the confirmation requests that are displayed to the user, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

<span data-ttu-id="7b0b9-236">Para obter mais informações sobre como declarar o atributo de cmdlet, consulte [declaração CmdletAttribute](./cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="7b0b9-236">For more information about how to declare the cmdlet attribute, see [CmdletAttribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

### <a name="override-an-input-processing-method-rc03"></a><span data-ttu-id="7b0b9-237">Substituir uma método (RC03) de processamento de entrada</span><span class="sxs-lookup"><span data-stu-id="7b0b9-237">Override an Input Processing Method (RC03)</span></span>

<span data-ttu-id="7b0b9-238">Para o cmdlet participar do ambiente do Windows PowerShell, ele deve substituir pelo menos um dos seguintes *métodos de processamento de entrada*.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-238">For the cmdlet to participate in the Windows PowerShell environment, it must override at least one of the following *input processing methods*.</span></span>

<span data-ttu-id="7b0b9-239">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) esse método é chamado uma vez, e ele é usado para fornecer a funcionalidade de pré-processamento.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-239">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) This method is called one time, and it is used to provide pre-processing functionality.</span></span>

<span data-ttu-id="7b0b9-240">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) esse método é chamado várias vezes, e ele é usado para fornecer a funcionalidade de registro por registro.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-240">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) This method is called multiple times, and it is used to provide record-by-record functionality.</span></span>

<span data-ttu-id="7b0b9-241">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) esse método é chamado uma vez, e ele é usado para fornecer funcionalidade de pós-processamento.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-241">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) This method is called one time, and it is used to provide post-processing functionality.</span></span>

### <a name="specify-the-outputtype-attribute-rc04"></a><span data-ttu-id="7b0b9-242">Especificar o atributo OutputType (RC04)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-242">Specify the OutputType Attribute (RC04)</span></span>

<span data-ttu-id="7b0b9-243">O atributo OutputType (introduzido no Windows PowerShell 2.0) Especifica o tipo do .NET Framework que seu cmdlet retorna para o pipeline.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-243">The OutputType attribute (introduced in Windows PowerShell 2.0) specifies the .NET Framework type that your cmdlet returns to the pipeline.</span></span> <span data-ttu-id="7b0b9-244">Especifica o tipo de saída de seus cmdlets faz com os objetos retornados pelo cmdlet mais detectáveis por outros cmdlets.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-244">By specifying the output type of your cmdlets you make the objects returned by your cmdlet more discoverable by other cmdlets.</span></span> <span data-ttu-id="7b0b9-245">Para obter mais informações sobre a decoração de classe do cmdlet com esse atributo, consulte [declaração de atributo OutputType](./outputtype-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="7b0b9-245">For more information about decorating the cmdlet class with this attribute, see [OutputType Attribute Declaration](./outputtype-attribute-declaration.md).</span></span>

### <a name="do-not-retain-handles-to-output-objects-rc05"></a><span data-ttu-id="7b0b9-246">Não manterá os identificadores de objetos de saída (RC05)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-246">Do Not Retain Handles to Output Objects (RC05)</span></span>

<span data-ttu-id="7b0b9-247">O cmdlet não deve reter os identificadores para os objetos que são passados para o [System.Management.Automation.Cmdlet.WriteObject\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) método.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-247">Your cmdlet should not retain any handles to the objects that are passed to the [System.Management.Automation.Cmdlet.WriteObject\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="7b0b9-248">Esses objetos são passados para o próximo cmdlet no pipeline, ou eles são usados por um script.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-248">These objects are passed to the next cmdlet in the pipeline, or they are used by a script.</span></span> <span data-ttu-id="7b0b9-249">Se você mantiver os identificadores de objetos, duas entidades possuirá cada objeto, o que causa erros.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-249">If you retain the handles to the objects, two entities will own each object, which causes errors.</span></span>

### <a name="handle-errors-robustly-rc06"></a><span data-ttu-id="7b0b9-250">Tratar erros robusto (RC06)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-250">Handle Errors Robustly (RC06)</span></span>

<span data-ttu-id="7b0b9-251">Um ambiente de administração inerentemente detecta e faz as alterações importantes no sistema que você está administrando.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-251">An administration environment inherently detects and makes important changes to the system that you are administering.</span></span> <span data-ttu-id="7b0b9-252">Portanto, é vital que cmdlets tratar erros corretamente.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-252">Therefore, it is vital that cmdlets handle errors correctly.</span></span> <span data-ttu-id="7b0b9-253">Para obter mais informações sobre os registros de erro, consulte [relatório de erros do Windows PowerShell](./error-reporting-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="7b0b9-253">For more information about error records, see [Windows PowerShell Error Reporting](./error-reporting-concepts.md).</span></span>

- <span data-ttu-id="7b0b9-254">Quando um erro impede que um cmdlet continua a processar qualquer mais registros, ele é um erro de encerramento.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-254">When an error prevents a cmdlet from continuing to process any more records, it is a terminating error.</span></span> <span data-ttu-id="7b0b9-255">O cmdlet deve chamar o [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) método que faz referência a um [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) objeto.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-255">The cmdlet must call the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="7b0b9-256">Se uma exceção não é detectada pelo cmdlet, o tempo de execução do Windows PowerShell em si gera um erro de encerramento que contém menos informações.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-256">If an exception is not caught by the cmdlet, the Windows PowerShell runtime itself throws a terminating error that contains less information.</span></span>

- <span data-ttu-id="7b0b9-257">Para um erro de finalização que não interrompe na próxima operação de registro que é proveniente de pipeline (por exemplo, um registro produzido por um processo diferente), o cmdlet deve chamar o [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) método faz referência a um [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) objeto.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-257">For a non-terminating error that does not stop operation on the next record that is coming from the pipeline (for example, a record produced by a different process), the cmdlet must call the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="7b0b9-258">Um exemplo de um erro de finalização é o erro que ocorre se um determinado processo falha ao parar.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-258">An example of a non-terminating error is the error that occurs if a particular process fails to stop.</span></span> <span data-ttu-id="7b0b9-259">Chamar o [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) método permite que o usuário para executar consistentemente as ações solicitadas e reter as informações de determinadas ações que falham.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-259">Calling the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method allows the user to consistently perform the actions requested and to retain the information for particular actions that fail.</span></span> <span data-ttu-id="7b0b9-260">O cmdlet deve tratar cada registro independentemente do quanto possível.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-260">Your cmdlet should handle each record as independently as possible.</span></span>

- <span data-ttu-id="7b0b9-261">O [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) que é referenciado pelo objeto de [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) e [ System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) métodos requer uma exceção em seu núcleo.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-261">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object that is referenced by the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) and [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) methods requires an exception at its core.</span></span> <span data-ttu-id="7b0b9-262">Siga as diretrizes de design do .NET Framework ao determinar a exceção a usar.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-262">Follow the .NET Framework design guidelines when you determine the exception to use.</span></span> <span data-ttu-id="7b0b9-263">Se o erro semanticamente é o mesmo que uma exceção existente, use essa exceção ou derivam dessa exceção.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-263">If the error is semantically the same as an existing exception, use that exception or derive from that exception.</span></span> <span data-ttu-id="7b0b9-264">Caso contrário, derive uma nova exceção ou hierarquia de exceções diretamente a partir de [System. Exception](/dotnet/api/System.Exception) tipo.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-264">Otherwise, derive a new exception or exception hierarchy directly from the [System.Exception](/dotnet/api/System.Exception) type.</span></span>

<span data-ttu-id="7b0b9-265">Uma [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) objeto também requer uma categoria de erro que agrupa os erros do usuário.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-265">An [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object also requires an error category that groups errors for the user.</span></span> <span data-ttu-id="7b0b9-266">O usuário pode exibir os erros com base na categoria, definindo o valor da `$ErrorView` variável do shell para CategoryView.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-266">The user can view errors based on the category by setting the value of the `$ErrorView` shell variable to CategoryView.</span></span> <span data-ttu-id="7b0b9-267">As categorias possíveis são definidas pela [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) enumeração.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-267">The possible categories are defined by the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) enumeration.</span></span>

- <span data-ttu-id="7b0b9-268">Se um cmdlet cria um novo thread, e se o código que está em execução nesse thread gera uma exceção sem tratamento, o Windows PowerShell não irá capturar o erro e encerrará o processo.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-268">If a cmdlet creates a new thread, and if the code that is running in that thread throws an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span>

- <span data-ttu-id="7b0b9-269">Se um objeto tiver um código em seu destruidor que faz com que uma exceção sem tratamento, o Windows PowerShell não irá capturar o erro e encerrará o processo.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-269">If an object has code in its destructor that causes an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span> <span data-ttu-id="7b0b9-270">Isso também ocorre se um objeto chama métodos Dispose que causam uma exceção sem tratamento.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-270">This also occurs if an object calls Dispose methods that cause an unhandled exception.</span></span>

### <a name="use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07"></a><span data-ttu-id="7b0b9-271">Usar um módulo do Windows PowerShell para implantar seus Cmdlets (RC07)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-271">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>

<span data-ttu-id="7b0b9-272">Crie um módulo do Windows PowerShell para empacotar e implantar seus cmdlets.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-272">Create a Windows PowerShell module to package and deploy your cmdlets.</span></span> <span data-ttu-id="7b0b9-273">Suporte para módulos é introduzido no Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-273">Support for modules is introduced in Windows PowerShell 2.0.</span></span> <span data-ttu-id="7b0b9-274">Você pode usar os assemblies que contêm suas classes de cmdlet diretamente como arquivos de módulo binário (Isso é muito útil ao testar seus cmdlets), ou você pode criar um manifesto de módulo que faz referência os assemblies de cmdlet.</span><span class="sxs-lookup"><span data-stu-id="7b0b9-274">You can use the assemblies that contain your cmdlet classes directly as binary module files (this is very useful when testing your cmdlets), or you can create a module manifest that references the cmdlet assemblies.</span></span> <span data-ttu-id="7b0b9-275">(Você também pode adicionar snap-in de assemblies existentes ao usar módulos.) Para obter mais informações sobre os módulos, consulte [escrevendo um módulo do Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="7b0b9-275">(You can also add existing snap-in assemblies when using modules.) For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="7b0b9-276">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="7b0b9-276">See Also</span></span>

[<span data-ttu-id="7b0b9-277">Diretrizes de desenvolvimento altamente incentivados</span><span class="sxs-lookup"><span data-stu-id="7b0b9-277">Strongly Encouraged Development Guidelines</span></span>](./strongly-encouraged-development-guidelines.md)

[<span data-ttu-id="7b0b9-278">Diretrizes de desenvolvimento de consultoria</span><span class="sxs-lookup"><span data-stu-id="7b0b9-278">Advisory Development Guidelines</span></span>](./advisory-development-guidelines.md)

<span data-ttu-id="7b0b9-279">[Writing a Windows PowerShell Cmdlet](./writing-a-windows-powershell-cmdlet.md) (Escrevendo um Cmdlet do Windows PowerShell)</span><span class="sxs-lookup"><span data-stu-id="7b0b9-279">[Writing a Windows PowerShell Cmdlet](./writing-a-windows-powershell-cmdlet.md)</span></span>
