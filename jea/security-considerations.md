---
ms.date: 2017-06-12
author: rpsqrd
ms.topic: conceptual
keywords: "jea,powershell,segurança"
title: "Considerações sobre segurança de JEA"
ms.openlocfilehash: f85b342625d4dba0890619ef9680eaccbbde5224
ms.sourcegitcommit: 75f70c7df01eea5e7a2c16f9a3ab1dd437a1f8fd
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/12/2017
---
# <a name="jea-security-considerations"></a><span data-ttu-id="e6f38-103">Considerações sobre segurança de JEA</span><span class="sxs-lookup"><span data-stu-id="e6f38-103">JEA Security Considerations</span></span>

> <span data-ttu-id="e6f38-104">Aplica-se a: Windows PowerShell 5.0</span><span class="sxs-lookup"><span data-stu-id="e6f38-104">Applies to: Windows PowerShell 5.0</span></span>

<span data-ttu-id="e6f38-105">O JEA ajuda a melhorar a sua situação de segurança, reduzindo o número de administradores permanentes em seus computadores.</span><span class="sxs-lookup"><span data-stu-id="e6f38-105">JEA helps you improve your security posture by reducing the number of permanent administrators on your machines.</span></span>
<span data-ttu-id="e6f38-106">Ele faz isso criando um novo ponto de entrada para os usuários para gerenciar o sistema (uma configuração de sessão do PowerShell) que é rigidamente bloqueada por padrão para evitar o uso indevido.</span><span class="sxs-lookup"><span data-stu-id="e6f38-106">It does so by creating a new entry point for users to manage the system (a PowerShell session configuration) which is tightly locked down by default to prevent misuse.</span></span>
<span data-ttu-id="e6f38-107">Usuários que precisam de algum acesso ao computador, mas não um acesso ilimitado, para realizar tarefas administrativas, podem ter acesso concedido ao ponto de extremidade JEA.</span><span class="sxs-lookup"><span data-stu-id="e6f38-107">Users who need some, but not unlimited, access to the machine to perform administrative tasks can be granted access to the JEA endpoint.</span></span>
<span data-ttu-id="e6f38-108">Como o JEA permite a execução de comandos de administrador sem ter diretamente o acesso de administrador, você então pode remover esses usuários de grupos de segurança altamente privilegiados (torná-los usuários padrão).</span><span class="sxs-lookup"><span data-stu-id="e6f38-108">Because JEA allows them to run admin commands without directly having admin access, you can then remove those users from highly privileged security groups (make them standard users).</span></span>

<span data-ttu-id="e6f38-109">Este tópico descreve o modelo de segurança JEA e as práticas recomendadas mais detalhadamente.</span><span class="sxs-lookup"><span data-stu-id="e6f38-109">This topic describes the JEA security model and best practices in more detail.</span></span>

## <a name="run-as-account"></a><span data-ttu-id="e6f38-110">Conta Executar como</span><span class="sxs-lookup"><span data-stu-id="e6f38-110">Run As account</span></span>

<span data-ttu-id="e6f38-111">Cada ponto de extremidade JEA tem uma conta "Run As" designada, que é a conta na qual são executadas as ações do usuário que está se conectando.</span><span class="sxs-lookup"><span data-stu-id="e6f38-111">Each JEA endpoint has a designated "run as" account, which is the account under which the connecting user's actions are performed.</span></span>
<span data-ttu-id="e6f38-112">Essa conta é configurável no [arquivo de configuração de sessão](session-configurations.md) e a conta que você escolher tem uma influência significativa sobre a segurança de seu ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="e6f38-112">This account is configurable in the [session configuration file](session-configurations.md), and the account you choose has a significant bearing on the security of your endpoint.</span></span>

<span data-ttu-id="e6f38-113">As **contas virtuais** são a maneira recomendada de se configurar a conta Run As.</span><span class="sxs-lookup"><span data-stu-id="e6f38-113">**Virtual accounts** are the recommended way of configuring the run as account.</span></span>
<span data-ttu-id="e6f38-114">As contas virtuais são avulsas, temporárias e locais que são criadas para o usuário que está se conectando para ser usada durante a duração de sua sessão JEA.</span><span class="sxs-lookup"><span data-stu-id="e6f38-114">Virtual accounts are one-time, temporary local accounts that are created for the connecting user to use during the duration of their JEA session.</span></span>
<span data-ttu-id="e6f38-115">Assim que a sessão é encerrada, a conta virtual será destruída e não poderá mais ser usada.</span><span class="sxs-lookup"><span data-stu-id="e6f38-115">As soon as their session is terminated, the virtual account will be destroyed and cannot be used anymore.</span></span>
<span data-ttu-id="e6f38-116">O usuário que está se conectando não conhece as credenciais da conta virtual e não pode usar a conta virtual para acessar o sistema por outros meios, como Área de Trabalho Remota ou um ponto de extremidade irrestrito do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="e6f38-116">The connecting user does not know the credentials for the virtual account and cannot use the virtual account to access the system via other means, such as Remote Desktop or an unconstrained PowerShell endpoint.</span></span>

<span data-ttu-id="e6f38-117">Por padrão, as contas virtuais pertencem ao grupo local de administradores no computador.</span><span class="sxs-lookup"><span data-stu-id="e6f38-117">By default, virtual accounts belong to the local administrators group on the machine.</span></span>
<span data-ttu-id="e6f38-118">Isso dá a eles direitos totais para gerenciar qualquer coisa no sistema, mas não dá direito para gerenciar recursos na rede.</span><span class="sxs-lookup"><span data-stu-id="e6f38-118">This gives them full rights to manage anything on the system, but no rights to manage resources on the network.</span></span>
<span data-ttu-id="e6f38-119">Durante a autenticação em outros computadores, o contexto do usuário será aquele da conta de computador local e não da conta virtual.</span><span class="sxs-lookup"><span data-stu-id="e6f38-119">When authenticating with other machines, the user context will be that of the local computer account, not the virtual account.</span></span>

<span data-ttu-id="e6f38-120">Os controladores de domínio são um caso especial, uma vez que não há um conceito de grupo de administradores locais.</span><span class="sxs-lookup"><span data-stu-id="e6f38-120">Domain controllers are a special case since there is no concept of a local administrators group.</span></span>
<span data-ttu-id="e6f38-121">Em vez disso, as contas virtuais pertencem a Administradores de Domínio e podem gerenciar os serviços de diretório no controlador de domínio.</span><span class="sxs-lookup"><span data-stu-id="e6f38-121">Instead, virtual accounts belong to Domain Admins instead and can manage the directory services on the domain controller.</span></span>
<span data-ttu-id="e6f38-122">A identidade do domínio ainda é restrita para uso no controlador de domínio onde a sessão da JEA foi instanciada e qualquer acesso à rede parecerá vir do objeto do computador controlador do domínio.</span><span class="sxs-lookup"><span data-stu-id="e6f38-122">The domain identity is still restricted to use on the domain controller where the JEA session was instantiated, and any network access will appear to come from the domain controller computer object instead.</span></span>

<span data-ttu-id="e6f38-123">Em ambos os casos, você pode definir explicitamente a quais grupos de segurança a conta virtual deve pertencer.</span><span class="sxs-lookup"><span data-stu-id="e6f38-123">In both cases, you can also explicitly define which security groups the virtual account should belong to.</span></span>
<span data-ttu-id="e6f38-124">Essa é uma boa prática quando você executa uma tarefa que pode ser feita sem privilégios de administrador local ou de domínio.</span><span class="sxs-lookup"><span data-stu-id="e6f38-124">This is a good practice when the task you are performing can be done without local/domain admin privileges.</span></span>
<span data-ttu-id="e6f38-125">Se você já tiver um grupo de segurança definido para seus administradores, você poderá simplesmente conceder a associação de conta virtual a esse grupo para dar a ele as permissões necessárias.</span><span class="sxs-lookup"><span data-stu-id="e6f38-125">If you already have a security group defined for your admins, you can simply grant the virtual account membership to that group to give it the permissions it needs.</span></span>
<span data-ttu-id="e6f38-126">A associação de grupo de conta virtual é limitada a grupos de segurança local na estação de trabalho e servidores membro, mas em um controlador de domínio, eles só podem ser membros de grupos de segurança de domínio.</span><span class="sxs-lookup"><span data-stu-id="e6f38-126">Virtual account group membership is limited to local security groups on workstation and member servers, but on a domain controller they can only be members of domain security groups.</span></span>
<span data-ttu-id="e6f38-127">Depois de especificar um ou mais grupos de segurança para a conta virtual pertencer, ela não pertencerá mais aos grupos padrão (administrador local ou administrador de domínio).</span><span class="sxs-lookup"><span data-stu-id="e6f38-127">Once you specify one or more security groups for the virtual account to belong to, it will no longer belong to the default groups (local admin or domain admin).</span></span>

<span data-ttu-id="e6f38-128">A tabela a seguir resume as opções de configuração possíveis e as permissões resultantes para as contas virtuais</span><span class="sxs-lookup"><span data-stu-id="e6f38-128">The table below summarizes the possible configuration options and resulting permissions for virtual accounts</span></span>

<span data-ttu-id="e6f38-129">Tipo de Computador</span><span class="sxs-lookup"><span data-stu-id="e6f38-129">Computer type</span></span>                | <span data-ttu-id="e6f38-130">Configuração do grupo de conta virtual</span><span class="sxs-lookup"><span data-stu-id="e6f38-130">Virtual account group configuration</span></span> | <span data-ttu-id="e6f38-131">Contexto de usuário local</span><span class="sxs-lookup"><span data-stu-id="e6f38-131">Local user context</span></span>                                      | <span data-ttu-id="e6f38-132">Contexto de usuário de rede</span><span class="sxs-lookup"><span data-stu-id="e6f38-132">Network user context</span></span>
-----------------------------|-------------------------------------|---------------------------------------------------------|--------------------------------------------------
<span data-ttu-id="e6f38-133">Controlador de domínio</span><span class="sxs-lookup"><span data-stu-id="e6f38-133">Domain controller</span></span>            | <span data-ttu-id="e6f38-134">Padrão</span><span class="sxs-lookup"><span data-stu-id="e6f38-134">Default</span></span>                             | <span data-ttu-id="e6f38-135">Usuário do domínio, membro de '*DOMÍNIO*\Administradores de Domínio'</span><span class="sxs-lookup"><span data-stu-id="e6f38-135">Domain user, member of '*DOMAIN*\Domain Admins'</span></span>         | <span data-ttu-id="e6f38-136">Conta de Computador</span><span class="sxs-lookup"><span data-stu-id="e6f38-136">Computer account</span></span>
<span data-ttu-id="e6f38-137">Controlador de domínio</span><span class="sxs-lookup"><span data-stu-id="e6f38-137">Domain controller</span></span>            | <span data-ttu-id="e6f38-138">Grupos de domínio A e B</span><span class="sxs-lookup"><span data-stu-id="e6f38-138">Domain groups A and B</span></span>               | <span data-ttu-id="e6f38-139">Usuário do domínio, membro de '*DOMÍNIO*\A', '*DOMÍNIO*\B'</span><span class="sxs-lookup"><span data-stu-id="e6f38-139">Domain user, member of '*DOMAIN*\A', '*DOMAIN*\B'</span></span>       | <span data-ttu-id="e6f38-140">Conta de Computador</span><span class="sxs-lookup"><span data-stu-id="e6f38-140">Computer account</span></span>
<span data-ttu-id="e6f38-141">Estação de trabalho ou servidor membro</span><span class="sxs-lookup"><span data-stu-id="e6f38-141">Member server or workstation</span></span> | <span data-ttu-id="e6f38-142">Padrão</span><span class="sxs-lookup"><span data-stu-id="e6f38-142">Default</span></span>                             | <span data-ttu-id="e6f38-143">Usuário local, membro de '*BUILTIN*\Administradores'</span><span class="sxs-lookup"><span data-stu-id="e6f38-143">Local user, member of '*BUILTIN*\Administrators'</span></span>        | <span data-ttu-id="e6f38-144">Conta de Computador</span><span class="sxs-lookup"><span data-stu-id="e6f38-144">Computer account</span></span>
<span data-ttu-id="e6f38-145">Estação de trabalho ou servidor membro</span><span class="sxs-lookup"><span data-stu-id="e6f38-145">Member server or workstation</span></span> | <span data-ttu-id="e6f38-146">Grupos locais C e D</span><span class="sxs-lookup"><span data-stu-id="e6f38-146">Local groups C and D</span></span>                | <span data-ttu-id="e6f38-147">Usuário local, membro de '*COMPUTADOR*\C' e '*COMPUTADOR*\D'</span><span class="sxs-lookup"><span data-stu-id="e6f38-147">Local user, member of '*COMPUTER*\C' and '*COMPUTER*\D'</span></span> | <span data-ttu-id="e6f38-148">Conta de Computador</span><span class="sxs-lookup"><span data-stu-id="e6f38-148">Computer account</span></span>

<span data-ttu-id="e6f38-149">Quando você examinar os eventos de auditoria de segurança e logs de eventos do aplicativo, verá que cada sessão de usuário JEA tem uma conta virtual exclusiva.</span><span class="sxs-lookup"><span data-stu-id="e6f38-149">When you look at security audit events and application event logs, you will see that each JEA user session has a unique virtual account.</span></span>
<span data-ttu-id="e6f38-150">Isso ajuda você a rastrear ações de usuário em um ponto de extremidade JEA até o usuário original que executou o comando.</span><span class="sxs-lookup"><span data-stu-id="e6f38-150">This helps you track user actions in a JEA endpoint back to the original user who ran the command.</span></span>
<span data-ttu-id="e6f38-151">Os nomes de conta virtual seguem o formato "WinRM Virtual Users\\WinRM\_VA\_*ACCOUNTNUMBER*\_*DOMAIN*\_*sAMAccountName*", por exemplo, se o usuário "Alice" no domínio "Contoso" reinicia um serviço em um ponto de extremidade JEA, o nome de usuário associado a qualquer evento do Gerenciador de Controle de Serviço seria "WinRM Virtual Users\\WinRM\_VA\_1\_contoso\_alice".</span><span class="sxs-lookup"><span data-stu-id="e6f38-151">Virtual account names follow the format "WinRM Virtual Users\\WinRM\_VA\_*ACCOUNTNUMBER*\_*DOMAIN*\_*sAMAccountName*" For example, if user "Alice" in domain "Contoso" restarts a service in a JEA endpoint, the username associated with any service control manager events would be "WinRM Virtual Users\\WinRM\_VA\_1\_contoso\_alice".</span></span>


<span data-ttu-id="e6f38-152">**As gMSAs (contas de serviço gerenciado de grupo)** são úteis quando um servidor membro necessita ter acesso aos recursos de rede na sessão JEA.</span><span class="sxs-lookup"><span data-stu-id="e6f38-152">**Group managed service accounts (gMSAs)** are useful when a member server needs to have access to network resources in the JEA session.</span></span>
<span data-ttu-id="e6f38-153">Um exemplo de uso é um ponto de extremidade JEA que é usado para controlar o acesso a uma API REST hospedada em um computador diferente.</span><span class="sxs-lookup"><span data-stu-id="e6f38-153">An example use case for this is a JEA endpoint that is used to control access to a REST API hosted on a different machine.</span></span>
<span data-ttu-id="e6f38-154">É fácil escrever funções para fazer as invocações desejadas na API REST, mas para autenticar na API, é necessário uma identidade de rede.</span><span class="sxs-lookup"><span data-stu-id="e6f38-154">It is easy to write functions to make the desired invocations on the REST API, but in order to authenticate with the API you need a network identity.</span></span>
<span data-ttu-id="e6f38-155">A utilização de uma conta de serviço gerenciado de grupo possibilita o "segundo salto", sem perder o controle sobre quais computadores podem usar a conta.</span><span class="sxs-lookup"><span data-stu-id="e6f38-155">Using a group managed service account makes the "second hop" possible while still having control over which computers can use the account.</span></span>
<span data-ttu-id="e6f38-156">As permissões efetivas da gMSA são definidas pelos grupos de segurança (local ou de domínio) ao qual a conta gMSA pertence.</span><span class="sxs-lookup"><span data-stu-id="e6f38-156">The effective permissions of the gMSA are defined by the security groups (local or domain) to which the gMSA account belongs.</span></span>

<span data-ttu-id="e6f38-157">Quando um ponto de extremidade JEA é configurado para usar uma conta gMSA, as ações de todos os usuários JEA parecerão vir da mesma conta de serviço gerenciado de grupo.</span><span class="sxs-lookup"><span data-stu-id="e6f38-157">When a JEA endpoint is configured to use a gMSA account, the actions of all JEA users will appear to come from the same group managed service account.</span></span>
<span data-ttu-id="e6f38-158">A única maneira de rastrear ações até um usuário específico é identificar o conjunto de comandos executados em uma transcrição de sessão do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="e6f38-158">The only way you can trace actions back to a specific user is to identify the set of commands run in a PowerShell session transcript.</span></span>

<span data-ttu-id="e6f38-159">As **credenciais pass-thru** são usadas quando você não especifica uma conta Run As e deseja que o PowerShell use a credencial dos usuários que estão se conectando para executar comandos no servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="e6f38-159">**Pass-thru credentials** are used when you do not speicfy a run as account and want PowerShell to use the connecting user's credential to run commands on the remote server.</span></span>
<span data-ttu-id="e6f38-160">Essa configuração *não* é recomendada para o JEA, pois exigiria conceder ao usuário que está se conectando o acesso direto aos grupos de gerenciamento privilegiado.</span><span class="sxs-lookup"><span data-stu-id="e6f38-160">This configuration is *not* recommended for JEA as it would require you to grant the connecting user direct access to privileged management groups.</span></span>
<span data-ttu-id="e6f38-161">Se o usuário que estiver se conectando já tiver privilégios de administrador, poderá evitar totalmente o JEA e gerenciar o sistema por outros meios irrestritos.</span><span class="sxs-lookup"><span data-stu-id="e6f38-161">If the connecting user already has admin privileges, they can avoid JEA altogether and manage the system via other, unconstrained means.</span></span>
<span data-ttu-id="e6f38-162">Consulte a seção abaixo sobre como [o JEA não protege contra administradores](#jea-does-not-protect-against-admins) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="e6f38-162">See the section below on how [JEA does not protect against admins](#jea-does-not-protect-against-admins) for more information.</span></span>

<span data-ttu-id="e6f38-163">**As contas Run As padrão** permitem especificar qualquer conta de usuário que executará toda a sessão do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="e6f38-163">**Standard run as accounts** allow you to specify any user account under which the entire PowerShell session will run.</span></span>
<span data-ttu-id="e6f38-164">Essa é uma distinção importante, porque uma configuração de sessão definida para usar uma conta Run As fixa (com o parâmetro `-RunAsCredential`) não reconhece o JEA.</span><span class="sxs-lookup"><span data-stu-id="e6f38-164">This is an important distinction, because a session configuration set to use a fixed run as account (with the `-RunAsCredential` parameter) is not JEA-aware.</span></span>
<span data-ttu-id="e6f38-165">Isso significa que as definições de função deixarão de funcionar conforme o esperado e todos os usuários autorizados a acessar o ponto de extremidade terão a mesma função atribuída.</span><span class="sxs-lookup"><span data-stu-id="e6f38-165">That means that role definitions no longer function as expected, and every user authorized to access the endpoint will be assigned the same role.</span></span>

<span data-ttu-id="e6f38-166">Você não deve usar um RunAsCredential em um ponto de extremidade JEA devido a dificuldade no rastreamento de ações até usuários específicos e devido à falta de suporte para mapeamento de usuários às funções.</span><span class="sxs-lookup"><span data-stu-id="e6f38-166">You should not use a RunAsCredential on a JEA endpoint because of the difficulty in tracing actions back to specific users and the lack of support for mapping users to roles.</span></span>

## <a name="winrm-endpoint-acl"></a><span data-ttu-id="e6f38-167">ACL do Ponto de Extremidade do WinRM</span><span class="sxs-lookup"><span data-stu-id="e6f38-167">WinRM Endpoint ACL</span></span>

<span data-ttu-id="e6f38-168">Assim como acontece com pontos de extremidade regulares de comunicação remota do PowerShell, cada ponto de extremidade JEA tem uma ACL (lista de controle de acesso) separada definida na configuração do WinRM que controla quem pode autenticar no ponto de extremidade JEA.</span><span class="sxs-lookup"><span data-stu-id="e6f38-168">As with regular PowerShell remoting endpoints, each JEA endpoint has a separate access control list (ACL) set in the WinRM configuration that controls who can authenticate with the JEA endpoint.</span></span>
<span data-ttu-id="e6f38-169">Se for configurada incorretamente, usuários confiáveis poderão não acessar o ponto de extremidade JEA e/ou usuários não confiáveis poderão acessar.</span><span class="sxs-lookup"><span data-stu-id="e6f38-169">If improperly configured, trusted users may not be able to access the JEA endpoint and/or untrusted users may gain access.</span></span>
<span data-ttu-id="e6f38-170">No entanto, a ACL do WinRM não afeta o mapeamento de usuários às funções JEA.</span><span class="sxs-lookup"><span data-stu-id="e6f38-170">The WinRM ACL does not, however, affect the mapping of users to JEA roles.</span></span>
<span data-ttu-id="e6f38-171">Este é controlado pelo campo *RoleDefinitions* no arquivo de configuração de sessão que foi registrado no sistema.</span><span class="sxs-lookup"><span data-stu-id="e6f38-171">That is controlled by the *RoleDefinitions* field in the session configuration file that was registered on the system.</span></span>

<span data-ttu-id="e6f38-172">Por padrão, quando você registra um ponto de extremidade JEA usando um arquivo de configuração de sessão e um ou mais recursos de função, a ACL do WinRM será configurada para permitir que todos os usuários com mapeamento para uma ou mais funções acessem o ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="e6f38-172">By default, when you register a JEA endpoint using a session configuration file and one or more role capabilities, the WinRM ACL will be configured to allow all users mapping to one or more roles access to the endpoint.</span></span>
<span data-ttu-id="e6f38-173">Por exemplo, uma sessão JEA configurada com o uso dos comandos a seguir, concede acesso total a *CONTOSO\JEA\_Lev1* e *CONTOSO\JEA\_Lev2*.</span><span class="sxs-lookup"><span data-stu-id="e6f38-173">For example, a JEA session configured using the following commands will grant full access to *CONTOSO\JEA\_Lev1* and *CONTOSO\JEA\_Lev2*.</span></span>

```powershell
$roles = @{ 'CONTOSO\JEA_Lev1' = 'Lev1Role'; 'CONTOSO\JEA_Lev2' = 'Lev2Role' }
New-PSSessionConfigurationFile -Path '.\jea.pssc' -SessionType RestrictedRemoteServer -RoleDefinitions $roles -RunAsVirtualAccount
Register-PSSessionConfiguration -Path '.\jea.pssc' -Name 'MyJEAEndpoint'
```

<span data-ttu-id="e6f38-174">Você pode auditar as permissões de usuário com o cmdlet [Get-PSSessionConfiguration](https://msdn.microsoft.com/en-us/powershell/reference/5.1/microsoft.powershell.core/get-pssessionconfiguration).</span><span class="sxs-lookup"><span data-stu-id="e6f38-174">You can audit user permissions with the [Get-PSSessionConfiguration](https://msdn.microsoft.com/en-us/powershell/reference/5.1/microsoft.powershell.core/get-pssessionconfiguration) cmdlet.</span></span>

```powershell
PS C:\> Get-PSSessionConfiguration -Name 'MyJEAEndpoint' | Select-Object Permission

Permission
----------
CONTOSO\JEA_Lev1 AccessAllowed
CONTOSO\JEA_Lev2 AccessAllowed
```

<span data-ttu-id="e6f38-175">Para alterar quais usuários têm acesso, execute `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` para um prompt interativo ou `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` para atualizar as permissões.</span><span class="sxs-lookup"><span data-stu-id="e6f38-175">To change which users have access, run either `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` for an interactive prompt or `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` to update the permissions.</span></span>
<span data-ttu-id="e6f38-176">Os usuários precisam, pelo menos, de direitos de *Invocar* para acessar o ponto de extremidade JEA.</span><span class="sxs-lookup"><span data-stu-id="e6f38-176">Users need at least *Invoke* rights to access the JEA endpoint.</span></span>

<span data-ttu-id="e6f38-177">Se usuários adicionais tiverem permissão para acessar o ponto de extremidade JEA, mas não se encaixarem em nenhuma das funções definidas no arquivo de configuração de sessão, eles poderão iniciar uma sessão JEA, mas terão acesso somente aos cmdlets padrão.</span><span class="sxs-lookup"><span data-stu-id="e6f38-177">If additional users are granted access to the JEA endpoint but do not fall into any of the roles defined in the session configuration file, they will be able to start a JEA session but only have access to the default cmdlets.</span></span>
<span data-ttu-id="e6f38-178">Você pode auditar as permissões de usuário em um ponto de extremidade JEA executando o `Get-PSSessionCapability`.</span><span class="sxs-lookup"><span data-stu-id="e6f38-178">You can audit user permissions in a JEA endpoint by running `Get-PSSessionCapability`.</span></span>
<span data-ttu-id="e6f38-179">Confira o artigo [Auditoria e relatórios no JEA](audit-and-report.md) para obter mais informações sobre a auditoria de quais comandos um usuário tem acesso em um ponto de extremidade JEA.</span><span class="sxs-lookup"><span data-stu-id="e6f38-179">Check out the [Auditing and Reporting on JEA](audit-and-report.md) article for more information about auditing which commands a user has access to in a JEA endpoint.</span></span>

## <a name="least-privilege-roles"></a><span data-ttu-id="e6f38-180">Funções de privilégio mínimo</span><span class="sxs-lookup"><span data-stu-id="e6f38-180">Least privilege roles</span></span>

<span data-ttu-id="e6f38-181">Durante a criação de funções JEA, é importante lembrar que a conta virtual ou a conta de serviço gerenciado de grupo em execução em segundo plano geralmente tem acesso irrestrito para gerenciar o computador local.</span><span class="sxs-lookup"><span data-stu-id="e6f38-181">When designing JEA roles, it is important to remember that the virtual or group managed service account running behind the scenes often has unrestricted access to manage the local machine.</span></span>
<span data-ttu-id="e6f38-182">Os recursos de função do JEA ajudam a restringir o uso que pode ser feito por essa conta, limitando os comandos e os aplicativos que podem ser executados usando o contexto privilegiado.</span><span class="sxs-lookup"><span data-stu-id="e6f38-182">JEA role capabilities help restrict what that account can be used for by limiting the commands and applications that can be run using that privileged context.</span></span>
<span data-ttu-id="e6f38-183">Funções desenvolvidas de modo inadequado podem permitir a execução de comandos perigosos que podem permitir que um usuário ultrapasse os limites do JEA ou obtenha acesso a informações confidenciais.</span><span class="sxs-lookup"><span data-stu-id="e6f38-183">Improperly designed roles can allow dangerous commands to run that may allow a user to break out of the JEA boundaries or obtain access to sensitive information.</span></span>

<span data-ttu-id="e6f38-184">Por exemplo, considere a seguinte entrada de capacidade de função:</span><span class="sxs-lookup"><span data-stu-id="e6f38-184">For example, consider the following role capability entry:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\*-Process'
}
```

<span data-ttu-id="e6f38-185">Essa capacidade de função permite que os usuários executem qualquer cmdlet do PowerShell com o substantivo "Processo" do módulo Microsoft.PowerShell.Management.</span><span class="sxs-lookup"><span data-stu-id="e6f38-185">This role capability allows users to run any PowerShell cmdlet with the noun "Process" from the Microsoft.PowerShell.Management module.</span></span>
<span data-ttu-id="e6f38-186">Os usuários podem precisar acessar cmdlets como o `Get-Process` para entender quais aplicativos estão sendo executados no sistema e o `Stop-Process` para eliminar qualquer aplicativo pendente.</span><span class="sxs-lookup"><span data-stu-id="e6f38-186">Users may need to access cmdlets like `Get-Process` to understand what applications are running on the system and `Stop-Process` to kill any hung applications.</span></span>
<span data-ttu-id="e6f38-187">No entanto, essa entrada também permite o `Start-Process`, que pode ser usado para iniciar um programa arbitrário com permissões de administrador completas.</span><span class="sxs-lookup"><span data-stu-id="e6f38-187">However, this entry also allows `Start-Process`, which can be used to start up an arbitrary program with full administrator permissions.</span></span>
<span data-ttu-id="e6f38-188">O programa não precisa ser instalado localmente no sistema, portanto um adversário pode simplesmente iniciar um programa em um compartilhamento de arquivo que concede privilégios de administrador local ao usuário que está se conectando, pode executar um malware e muito mais.'</span><span class="sxs-lookup"><span data-stu-id="e6f38-188">The program doesn't need to be installed locally on the system, so an adversary could simply start a program on a file share that gives the connecting user local admin privileges, runs malware, and more.'</span></span>

<span data-ttu-id="e6f38-189">Uma versão muito mais segura desse mesma capacidade de função seria:</span><span class="sxs-lookup"><span data-stu-id="e6f38-189">A more secure version of this same role capability would look like:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\Get-Process', 'Microsoft.PowerShell.Management\Stop-Process'
}
```

<span data-ttu-id="e6f38-190">Evite usar curingas em recursos de função e não se esqueça de [auditar as permissões efetivas de usuário](audit-and-report.md#check-effective-rights-for-a-specific-user) regularmente para entender a quais comandos um usuário tem acesso.</span><span class="sxs-lookup"><span data-stu-id="e6f38-190">Avoid using wildcards in role capabilities, and be sure to [audit effective user permissions](audit-and-report.md#check-effective-rights-for-a-specific-user) regularly to understand which commands a user has access to.</span></span>

## <a name="jea-does-not-protect-against-admins"></a><span data-ttu-id="e6f38-191">O JEA não protege contra administradores</span><span class="sxs-lookup"><span data-stu-id="e6f38-191">JEA does not protect against admins</span></span>

<span data-ttu-id="e6f38-192">Um aos princípios básicos do JEA é que ele permite que não administradores executem *algumas* tarefas de administração.</span><span class="sxs-lookup"><span data-stu-id="e6f38-192">One of the core principles of JEA is that it allows non-admins to perform *some* admin tasks.</span></span>
<span data-ttu-id="e6f38-193">O JEA não protege contra aqueles que já têm privilégios de administrador.</span><span class="sxs-lookup"><span data-stu-id="e6f38-193">JEA does not protect against those who already have administrator privileges.</span></span>
<span data-ttu-id="e6f38-194">Os usuários que pertencem a "administradores do domínio", "administradores local" ou outros grupos altamente privilegiados no seu ambiente ainda poderão contornar as proteções do JEA, conectando-se ao computador por outras formas.</span><span class="sxs-lookup"><span data-stu-id="e6f38-194">Users who belong "domain admins," "local admins," or other highly privileged groups in your environment will still be able to get around JEA's protections by signing into the machine via another means.</span></span>
<span data-ttu-id="e6f38-195">Eles poderiam, por exemplo, entrar com o RDP, usar os consoles remotos do MMC ou conectar-se aos pontos de extremidade irrestritos do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="e6f38-195">They could, for example, sign in with RDP, use remote MMC consoles, or connect to unconstrained PowerShell endpoints.</span></span>
<span data-ttu-id="e6f38-196">Os administradores locais no sistema também podem modificar as configurações de JEA para permitir que usuários adicionais gerenciem o sistema ou alterem uma capacidade de função para estender o escopo do que um usuário pode fazer em sua sessão JEA.</span><span class="sxs-lookup"><span data-stu-id="e6f38-196">Local admins on the system can also modify JEA configurations to allow additional users to manage the system or change a role capability to extend the scope of what a user can do in their JEA session.</span></span>
<span data-ttu-id="e6f38-197">Portanto, é importante avaliar as permissões estendidas dos usuários de JEA para ver se existem outras maneiras pelas quais eles poderiam obter acesso privilegiado ao sistema.</span><span class="sxs-lookup"><span data-stu-id="e6f38-197">It is therefore important to evaluate your JEA users' extended permissions to see if there are other ways they could gain privileged access to the system.</span></span>

<span data-ttu-id="e6f38-198">Uma prática comum é usar o JEA para a manutenção de rotina e usar uma solução de gerenciamento de acesso privilegiado "just in time" que permita que os usuários sejam temporariamente administradores locais em situações de emergência.</span><span class="sxs-lookup"><span data-stu-id="e6f38-198">A common practice is to use JEA for regular day-to-day maintenance and have a "just in time" privileged access management solution allow users to temporarily become local admins in emergency situations.</span></span>
<span data-ttu-id="e6f38-199">Isso ajuda a garantir que os usuários não sejam administradores permanentes no sistema, mas possam obter esses direitos se e somente quando concluírem um fluxo de trabalho que documente o uso dessas permissões.</span><span class="sxs-lookup"><span data-stu-id="e6f38-199">This helps ensure users are not permanent admins on the system, but can get those rights if, and only when, they complete a workflow that documents their use of those permissions.</span></span>

